var rrwebPlayer = (function() {
 "use strict"; function e() {} function t(e, t) { for (const n in t)e[n] = t[n]; return e } function n(e) { return e() } function r() { return Object.create(null) } function o(e) { e.forEach(n) } function i(e) { return typeof e == "function" } function a(e, t) { return e != e ? t == t : e !== t || e && typeof e == "object" || typeof e == "function" } function s(e) { const t = {}; for (const n in e)n[0] !== "$" && (t[n] = e[n]); return t } function l(e, t) { e.appendChild(t) } function c(e, t, n) { e.insertBefore(t, n || null) } function u(e) { e.parentNode.removeChild(e) } function d(e, t) { for (let n = 0; n < e.length; n += 1)e[n] && e[n].d(t) } function f(e) { return document.createElement(e) } function p(e) { return document.createElementNS("http://www.w3.org/2000/svg", e) } function h(e) { return document.createTextNode(e) } function m() { return h(" ") } function v(e, t, n, r) { return e.addEventListener(t, n, r), () => e.removeEventListener(t, n, r) } function g(e, t, n) { n == null ? e.removeAttribute(t) : e.getAttribute(t) !== n && e.setAttribute(t, n) } function y(e, t) { t = "" + t, e.wholeText !== t && (e.data = t) } function w(e, t, n, r) { e.style.setProperty(t, n, r ? "important" : "") } function b(e, t, n) { e.classList[n ? "add" : "remove"](t) }let x; function E(e) { x = e } function S() { if (!x) throw new Error("Function called outside component initialization"); return x } function M(e) { S().$$.on_mount.push(e) } function T(e) { S().$$.on_destroy.push(e) } function k() { const e = S(); return (t, n) => { const r = e.$$.callbacks[t]; if (r) { const o = (function(e, t) { const n = document.createEvent("CustomEvent"); return n.initCustomEvent(e, !1, !1, t), n }(t, n)); r.slice().forEach(t => { t.call(e, o) }) } } } const C = [], I = [], N = [], _ = [], $ = Promise.resolve(); let A = !1; function D(e) { N.push(e) }let F = !1; const O = new Set(); function L() { if (!F) { F = !0; do { for (let e = 0; e < C.length; e += 1) { const t = C[e]; E(t), P(t.$$) } for (C.length = 0; I.length;)I.pop()(); for (let e = 0; e < N.length; e += 1) { const t = N[e]; O.has(t) || (O.add(t), t()) }N.length = 0 } while (C.length);for (;_.length;)_.pop()(); A = !1, F = !1, O.clear() } } function P(e) { if (e.fragment !== null) { e.update(), o(e.before_update); const t = e.dirty; e.dirty = [-1], e.fragment && e.fragment.p(e.ctx, t), e.after_update.forEach(D) } } const R = new Set(); let j; function B() { j = {r: 0, c: [], p: j} } function z() { j.r || o(j.c), j = j.p } function q(e, t) { e && e.i && (R.delete(e), e.i(t)) } function U(e, t, n, r) { if (e && e.o) { if (R.has(e)) return; R.add(e), j.c.push(() => { R.delete(e), r && (n && e.d(1), r()) }), e.o(t) } } function V(e) { e && e.c() } function W(e, t, r) { const {fragment: a, on_mount: s, on_destroy: l, after_update: c} = e.$$; a && a.m(t, r), D(() => { const t = s.map(n).filter(i); l ? l.push(...t) : o(t), e.$$.on_mount = [] }), c.forEach(D) } function H(e, t) { const n = e.$$; n.fragment !== null && (o(n.on_destroy), n.fragment && n.fragment.d(t), n.on_destroy = n.fragment = null, n.ctx = []) } function X(e, t) { e.$$.dirty[0] === -1 && (C.push(e), A || (A = !0, $.then(L)), e.$$.dirty.fill(0)), e.$$.dirty[t / 31 | 0] |= 1 << t % 31 } function Y(t, n, i, a, s, l, c = [-1]) { const d = x; E(t); const f = n.props || {}, p = t.$$ = {fragment: null, ctx: null, props: l, update: e, not_equal: s, bound: r(), on_mount: [], on_destroy: [], before_update: [], after_update: [], context: new Map(d ? d.$$.context : []), callbacks: r(), dirty: c}; let h = !1; if (p.ctx = i ? i(t, f, (e, n, ...r) => { const o = r.length ? r[0] : n; return p.ctx && s(p.ctx[e], p.ctx[e] = o) && (p.bound[e] && p.bound[e](o), h && X(t, e)), n }) : [], p.update(), h = !0, o(p.before_update), p.fragment = !!a && a(p.ctx), n.target) { if (n.hydrate) { const e = (function(e) { return Array.from(e.childNodes) }(n.target)); p.fragment && p.fragment.l(e), e.forEach(u) } else p.fragment && p.fragment.c(); n.intro && q(t.$$.fragment), W(t, n.target, n.anchor), L() }E(d) } class Q {$destroy() { H(this, 1), this.$destroy = e }$on(e, t) { const n = this.$$.callbacks[e] || (this.$$.callbacks[e] = []); return n.push(t), () => { const e = n.indexOf(t); e !== -1 && n.splice(e, 1) } }$set() {}} var G, J, K, Z, ee; !(function(e) { e[e.DomContentLoaded = 0] = "DomContentLoaded", e[e.Load = 1] = "Load", e[e.FullSnapshot = 2] = "FullSnapshot", e[e.IncrementalSnapshot = 3] = "IncrementalSnapshot", e[e.Meta = 4] = "Meta", e[e.Custom = 5] = "Custom" }(G || (G = {}))), (function(e) { e[e.Mutation = 0] = "Mutation", e[e.MouseMove = 1] = "MouseMove", e[e.MouseInteraction = 2] = "MouseInteraction", e[e.Scroll = 3] = "Scroll", e[e.ViewportResize = 4] = "ViewportResize", e[e.Input = 5] = "Input", e[e.TouchMove = 6] = "TouchMove", e[e.MediaInteraction = 7] = "MediaInteraction", e[e.StyleSheetRule = 8] = "StyleSheetRule", e[e.CanvasMutation = 9] = "CanvasMutation", e[e.Font = 10] = "Font", e[e.Log = 11] = "Log", e[e.Drag = 12] = "Drag" }(J || (J = {}))), (function(e) { e[e.MouseUp = 0] = "MouseUp", e[e.MouseDown = 1] = "MouseDown", e[e.Click = 2] = "Click", e[e.ContextMenu = 3] = "ContextMenu", e[e.DblClick = 4] = "DblClick", e[e.Focus = 5] = "Focus", e[e.Blur = 6] = "Blur", e[e.TouchStart = 7] = "TouchStart", e[e.TouchMove_Departed = 8] = "TouchMove_Departed", e[e.TouchEnd = 9] = "TouchEnd" }(K || (K = {}))), (function(e) { e[e.Play = 0] = "Play", e[e.Pause = 1] = "Pause" }(Z || (Z = {}))), (function(e) { e.Start = "start", e.Pause = "pause", e.Resume = "resume", e.Resize = "resize", e.Finish = "finish", e.FullsnapshotRebuilded = "fullsnapshot-rebuilded", e.LoadStylesheetStart = "load-stylesheet-start", e.LoadStylesheetEnd = "load-stylesheet-end", e.SkipStart = "skip-start", e.SkipEnd = "skip-end", e.MouseInteraction = "mouse-interaction", e.EventCast = "event-cast", e.CustomEvent = "custom-event", e.Flush = "flush", e.StateChange = "state-change", e.PlayBack = "play-back", e.AddEventEnd = "add-event-end" }(ee || (ee = {})));
  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation.

      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.

      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
  var te, ne = function() { return (ne = Object.assign || function(e) { for (var t, n = 1, r = arguments.length; n < r; n++) for (var o in t = arguments[n])Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]); return e }).apply(this, arguments) }; function re(e) { var t = typeof Symbol == "function" && Symbol.iterator, n = t && e[t], r = 0; if (n) return n.call(e); if (e && typeof e.length == "number") return {next: function() { return e && r >= e.length && (e = void 0), {value: e && e[r++], done: !e} }}; throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.") } function oe(e, t) { var n = typeof Symbol == "function" && e[Symbol.iterator]; if (!n) return e; var r, o, i = n.call(e), a = []; try { for (;(void 0 === t || t-- > 0) && !(r = i.next()).done;)a.push(r.value) } catch (e) { o = {error: e} } finally { try { r && !r.done && (n = i.return) && n.call(i) } finally { if (o) throw o.error } } return a } function ie() { for (var e = [], t = 0; t < arguments.length; t++)e = e.concat(oe(arguments[t])); return e } function ae(e) { return e.nodeType === e.ELEMENT_NODE }!(function(e) { e[e.Document = 0] = "Document", e[e.DocumentType = 1] = "DocumentType", e[e.Element = 2] = "Element", e[e.Text = 3] = "Text", e[e.CDATA = 4] = "CDATA", e[e.Comment = 5] = "Comment" }(te || (te = {}))); var se = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g; function le(e, t) { void 0 === t && (t = {}); var n = 1, r = 1; function o(e) { var t = e.match(/\n/g); t && (n += t.length); var o = e.lastIndexOf("\n"); r = o === -1 ? r + e.length : e.length - o } function i() { var e = {line: n, column: r}; return function(t) { return t.position = new a(e), p(), t } } var a = function(e) { this.start = e, this.end = {line: n, column: r}, this.source = t.source }; a.prototype.content = e; var s = []; function l(o) { var i = new Error(t.source + ":" + n + ":" + r + ": " + o); if (i.reason = o, i.filename = t.source, i.line = n, i.column = r, i.source = e, !t.silent) throw i; s.push(i) } function c() { return f(/^{\s*/) } function u() { return f(/^}/) } function d() { var t, n = []; for (p(), h(n); e.length && e.charAt(0) !== "}" && (t = T() || k());)!1 !== t && (n.push(t), h(n)); return n } function f(t) { var n = t.exec(e); if (n) { var r = n[0]; return o(r), e = e.slice(r.length), n } } function p() { f(/^\s*/) } function h(e) { var t; for (void 0 === e && (e = []); t = m();)!1 !== t && e.push(t), t = m(); return e } function m() { var t = i(); if (e.charAt(0) === "/" && e.charAt(1) === "*") { for (var n = 2; e.charAt(n) !== "" && (e.charAt(n) !== "*" || e.charAt(n + 1) !== "/");)++n; if (n += 2, e.charAt(n - 1) === "") return l("End of comment missing"); var a = e.slice(2, n - 2); return r += 2, o(a), e = e.slice(n), r += 2, t({type: "comment", comment: a}) } } function v() { var e = f(/^([^{]+)/); if (e) return ce(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, "").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function(e) { return e.replace(/,/g, "â€Œ") }).split(/\s*(?![^(]*\)),\s*/).map(function(e) { return e.replace(/\u200C/g, ",") }) } function g() { var e = i(), t = f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/); if (t) { var n = ce(t[0]); if (!f(/^:\s*/)) return l("property missing ':'"); var r = f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/), o = e({type: "declaration", property: n.replace(se, ""), value: r ? ce(r[0]).replace(se, "") : ""}); return f(/^[;\s]*/), o } } function y() { var e, t = []; if (!c()) return l("missing '{'"); for (h(t); e = g();)!1 !== e && (t.push(e), h(t)), e = g(); return u() ? t : l("missing '}'") } function w() { for (var e, t = [], n = i(); e = f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]), f(/^,\s*/); if (t.length) return n({type: "keyframe", values: t, declarations: y()}) } var b, x = M("import"), E = M("charset"), S = M("namespace"); function M(e) { var t = new RegExp("^@" + e + "\\s*([^;]+);"); return function() { var n = i(), r = f(t); if (r) { var o = {type: e}; return o[e] = r[1].trim(), n(o) } } } function T() { if (e[0] === "@") return (function() { var e = i(), t = f(/^@([-\w]+)?keyframes\s*/); if (t) { var n = t[1]; if (!(t = f(/^([-\w]+)\s*/))) return l("@keyframes missing name"); var r, o = t[1]; if (!c()) return l("@keyframes missing '{'"); for (var a = h(); r = w();)a.push(r), a = a.concat(h()); return u() ? e({type: "keyframes", name: o, vendor: n, keyframes: a}) : l("@keyframes missing '}'") } }()) || (function() { var e = i(), t = f(/^@media *([^{]+)/); if (t) { var n = ce(t[1]); if (!c()) return l("@media missing '{'"); var r = h().concat(d()); return u() ? e({type: "media", media: n, rules: r}) : l("@media missing '}'") } }()) || (function() { var e = i(), t = f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/); if (t) return e({type: "custom-media", name: ce(t[1]), media: ce(t[2])}) }()) || (function() { var e = i(), t = f(/^@supports *([^{]+)/); if (t) { var n = ce(t[1]); if (!c()) return l("@supports missing '{'"); var r = h().concat(d()); return u() ? e({type: "supports", supports: n, rules: r}) : l("@supports missing '}'") } }()) || x() || E() || S() || (function() { var e = i(), t = f(/^@([-\w]+)?document *([^{]+)/); if (t) { var n = ce(t[1]), r = ce(t[2]); if (!c()) return l("@document missing '{'"); var o = h().concat(d()); return u() ? e({type: "document", document: r, vendor: n, rules: o}) : l("@document missing '}'") } }()) || (function() { var e = i(); if (f(/^@page */)) { var t = v() || []; if (!c()) return l("@page missing '{'"); for (var n, r = h(); n = g();)r.push(n), r = r.concat(h()); return u() ? e({type: "page", selectors: t, declarations: r}) : l("@page missing '}'") } }()) || (function() { var e = i(); if (f(/^@host\s*/)) { if (!c()) return l("@host missing '{'"); var t = h().concat(d()); return u() ? e({type: "host", rules: t}) : l("@host missing '}'") } }()) || (function() { var e = i(); if (f(/^@font-face\s*/)) { if (!c()) return l("@font-face missing '{'"); for (var t, n = h(); t = g();)n.push(t), n = n.concat(h()); return u() ? e({type: "font-face", declarations: n}) : l("@font-face missing '}'") } }()) } function k() { var e = i(), t = v(); return t ? (h(), e({type: "rule", selectors: t, declarations: y()})) : l("selector missing") } return (function e(t, n) { for (var r = t && typeof t.type == "string", o = r ? t : n, i = 0, a = Object.keys(t); i < a.length; i++) { var s = a[i], l = t[s]; Array.isArray(l) ? l.forEach(function(t) { e(t, o) }) : l && typeof l == "object" && e(l, o) }r && Object.defineProperty(t, "parent", {configurable: !0, writable: !0, enumerable: !1, value: n || null}); return t }((b = d(), {type: "stylesheet", stylesheet: {source: t.source, rules: b, parsingErrors: s}}))) } function ce(e) { return e ? e.replace(/^\s+|\s+$/g, "") : "" } var ue = {script: "noscript", altglyph: "altGlyph", altglyphdef: "altGlyphDef", altglyphitem: "altGlyphItem", animatecolor: "animateColor", animatemotion: "animateMotion", animatetransform: "animateTransform", clippath: "clipPath", feblend: "feBlend", fecolormatrix: "feColorMatrix", fecomponenttransfer: "feComponentTransfer", fecomposite: "feComposite", feconvolvematrix: "feConvolveMatrix", fediffuselighting: "feDiffuseLighting", fedisplacementmap: "feDisplacementMap", fedistantlight: "feDistantLight", fedropshadow: "feDropShadow", feflood: "feFlood", fefunca: "feFuncA", fefuncb: "feFuncB", fefuncg: "feFuncG", fefuncr: "feFuncR", fegaussianblur: "feGaussianBlur", feimage: "feImage", femerge: "feMerge", femergenode: "feMergeNode", femorphology: "feMorphology", feoffset: "feOffset", fepointlight: "fePointLight", fespecularlighting: "feSpecularLighting", fespotlight: "feSpotLight", fetile: "feTile", feturbulence: "feTurbulence", foreignobject: "foreignObject", glyphref: "glyphRef", lineargradient: "linearGradient", radialgradient: "radialGradient"}; var de = /([^\\]):hover/, fe = new RegExp(de, "g"); function pe(e) { var t = le(e, {silent: !0}); if (!t.stylesheet) return e; var n = []; if (t.stylesheet.rules.forEach(function(e) { "selectors" in e && (e.selectors || []).forEach(function(e) { de.test(e) && n.push(e) }) }), n.length === 0) return e; var r = new RegExp(n.filter(function(e, t) { return n.indexOf(e) === t }).sort(function(e, t) { return t.length - e.length }).map(function(e) { return e.replace(/[.*+?^${}()|[\]\\]/g, "\\$&") }).join("|"), "g"); return e.replace(r, function(e) { var t = e.replace(fe, "$1.\\:hover"); return e + ", " + t }) } function he(e, t) { var n = t.doc, r = t.hackCss; switch (e.type) { case te.Document:return n.implementation.createDocument(null, "", null); case te.DocumentType:return n.implementation.createDocumentType(e.name || "html", e.publicId, e.systemId); case te.Element:var o, i = (function(e) { var t = ue[e.tagName] ? ue[e.tagName] : e.tagName; return t === "link" && e.attributes._cssText && (t = "style"), t }(e)); o = e.isSVG ? n.createElementNS("http://www.w3.org/2000/svg", i) : n.createElement(i); var a = function(t) { if (!e.attributes.hasOwnProperty(t)) return "continue"; var a = e.attributes[t]; if (a = typeof a == "boolean" || typeof a == "number" ? "" : a, t.startsWith("rr_")) { if (i === "canvas" && t === "rr_dataURL") { var s = document.createElement("img"); s.src = a, s.onload = function() { var e = o.getContext("2d"); e && e.drawImage(s, 0, 0, s.width, s.height) } } if (t === "rr_width" && (o.style.width = a), t === "rr_height" && (o.style.height = a), t === "rr_mediaState") switch (a) { case "played":o.play(); case "paused":o.pause() } } else { var l = i === "textarea" && t === "value", c = i === "style" && t === "_cssText"; if (c && r && (a = pe(a)), l || c) { for (var u = n.createTextNode(a), d = 0, f = Array.from(o.childNodes); d < f.length; d++) { var p = f[d]; p.nodeType === o.TEXT_NODE && o.removeChild(p) } return o.appendChild(u), "continue" } if (i === "iframe" && t === "src") return "continue"; try { e.isSVG && t === "xlink:href" ? o.setAttributeNS("http://www.w3.org/1999/xlink", t, a) : t === "onload" || t === "onclick" || t.substring(0, 7) === "onmouse" ? o.setAttribute("_" + t, a) : o.setAttribute(t, a) } catch (e) {} } }; for (var s in e.attributes)a(s); if (e.isShadowHost) if (o.shadowRoot) for (;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild); else o.attachShadow({mode: "open"}); return o; case te.Text:return n.createTextNode(e.isStyle && r ? pe(e.textContent) : e.textContent); case te.CDATA:return n.createCDATASection(e.textContent); case te.Comment:return n.createComment(e.textContent); default:return null } } function me(e, t) { var n = t.doc, r = t.map, o = t.skipChild, i = void 0 !== o && o, a = t.hackCss, s = void 0 === a || a, l = t.afterAppend, c = he(e, {doc: n, hackCss: s}); if (!c) return null; if (e.rootId && console.assert(r[e.rootId] === n, "Target document should has the same root id."), e.type === te.Document && (n.close(), n.open(), c = n), c.__sn = e, r[e.id] = c, (e.type === te.Document || e.type === te.Element) && !i) for (var u = 0, d = e.childNodes; u < d.length; u++) { var f = d[u], p = me(f, {doc: n, map: r, skipChild: !1, hackCss: s, afterAppend: l}); p ? (f.isShadow && ae(c) && c.shadowRoot ? c.shadowRoot.appendChild(p) : c.appendChild(p), l && l(p)) : console.warn("Failed to rebuild", f) } return c } function ve(e, t) { var n = t.doc, r = t.onVisit, o = t.hackCss, i = {}, a = me(e, {doc: n, map: i, skipChild: !1, hackCss: void 0 === o || o, afterAppend: t.afterAppend}); return (function(e, t) { for (var n in e)e[n] && (r = e[n], t(r)); var r }(i, function(e) { r && r(e), (function(e) { var t = e.__sn; if (t.type === te.Element) { var n = e; for (var r in t.attributes) if (t.attributes.hasOwnProperty(r) && r.startsWith("rr_")) { var o = t.attributes[r]; r === "rr_scrollLeft" && (n.scrollLeft = o), r === "rr_scrollTop" && (n.scrollTop = o) } } }(e)) })), [a, i] } var ge = "Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.", ye = {map: {}, getId: function() { return console.error(ge), -1 }, getNode: function() { return console.error(ge), null }, removeNodeFromMap: function() { console.error(ge) }, has: function() { return console.error(ge), !1 }, reset: function() { console.error(ge) }}; typeof window != "undefined" && window.Proxy && window.Reflect && (ye = new Proxy(ye, {get: function(e, t, n) { return t === "map" && console.error(ge), Reflect.get(e, t, n) }})); var we = (function() { function e() { this.reset() } return e.prototype.add = function(e) { var t = this.indexes.get(e.parentId), n = {id: e.node.id, mutation: e, children: [], texts: [], attributes: []}; t ? (n.parent = t, t.children[n.id] = n) : this.tree[n.id] = n, this.indexes.set(n.id, n) }, e.prototype.remove = function(e, t) { var n = this, r = this.indexes.get(e.parentId), o = this.indexes.get(e.id), i = function(e) { n.removeIdSet.add(e); var r = t.getNode(e); r == null || r.childNodes.forEach(function(e) { "__sn" in e && i(e.__sn.id) }) }, a = function(t) { n.removeIdSet.add(t.id), Object.values(t.children).forEach(function(e) { return a(e) }); var r = n.indexes.get(t.id); if (r) { var o = r.parent; o && (delete r.parent, delete o.children[r.id], n.indexes.delete(e.id)) } }; o ? r ? (delete o.parent, delete r.children[o.id], this.indexes.delete(e.id), a(o)) : (delete this.tree[o.id], this.indexes.delete(o.id), a(o)) : (this.removeNodeMutations.push(e), i(e.id)) }, e.prototype.text = function(e) { var t = this.indexes.get(e.id); t ? t.texts.push(e) : this.textMutations.push(e) }, e.prototype.attribute = function(e) { var t = this.indexes.get(e.id); t ? t.attributes.push(e) : this.attributeMutations.push(e) }, e.prototype.scroll = function(e) { this.scrollMap.set(e.id, e) }, e.prototype.input = function(e) { this.inputMap.set(e.id, e) }, e.prototype.flush = function() { var e, t, n, r, o = this, i = this.tree, a = this.removeNodeMutations, s = this.textMutations, l = this.attributeMutations, c = {source: J.Mutation, removes: a, texts: s, attributes: l, adds: []}, u = function(e, t) { t && o.removeIdSet.add(e.id), c.texts = c.texts.concat(t ? [] : e.texts).filter(function(e) { return !o.removeIdSet.has(e.id) }), c.attributes = c.attributes.concat(t ? [] : e.attributes).filter(function(e) { return !o.removeIdSet.has(e.id) }), o.removeIdSet.has(e.id) || o.removeIdSet.has(e.mutation.parentId) || t ? Object.values(e.children).forEach(function(e) { return u(e, !0) }) : (c.adds.push(e.mutation), e.children && Object.values(e.children).forEach(function(e) { return u(e, !1) })) }; Object.values(i).forEach(function(e) { return u(e, !1) }); try { for (var d = re(this.scrollMap.keys()), f = d.next(); !f.done; f = d.next()) { var p = f.value; this.removeIdSet.has(p) && this.scrollMap.delete(p) } } catch (t) { e = {error: t} } finally { try { f && !f.done && (t = d.return) && t.call(d) } finally { if (e) throw e.error } } try { for (var h = re(this.inputMap.keys()), m = h.next(); !m.done; m = h.next()) { p = m.value; this.removeIdSet.has(p) && this.inputMap.delete(p) } } catch (e) { n = {error: e} } finally { try { m && !m.done && (r = h.return) && r.call(h) } finally { if (n) throw n.error } } var v = new Map(this.scrollMap), g = new Map(this.inputMap); return this.reset(), {mutationData: c, scrollMap: v, inputMap: g} }, e.prototype.reset = function() { this.tree = [], this.indexes = new Map(), this.removeNodeMutations = [], this.textMutations = [], this.attributeMutations = [], this.removeIdSet = new Set(), this.scrollMap = new Map(), this.inputMap = new Map() }, e }()); function be(e) { var t, n, r = {}, o = function(e, t) { var n = {value: e, parent: t, children: []}; return r[e.node.id] = n, n }, i = []; try { for (var a = re(e), s = a.next(); !s.done; s = a.next()) { var l = s.value, c = l.nextId, u = l.parentId; if (c && c in r) { var d = r[c]; if (d.parent) { var f = d.parent.children.indexOf(d); d.parent.children.splice(f, 0, o(l, d.parent)) } else { f = i.indexOf(d); i.splice(f, 0, o(l, null)) } } else if (u in r) { var p = r[u]; p.children.push(o(l, p)) } else i.push(o(l, null)) } } catch (e) { t = {error: e} } finally { try { s && !s.done && (n = a.return) && n.call(a) } finally { if (t) throw t.error } } return i } function xe(e, t) { t(e.value); for (var n = e.children.length - 1; n >= 0; n--)xe(e.children[n], t) } function Ee(e) { return "__sn" in e && (e.__sn.type === te.Element && e.__sn.tagName === "iframe") } function Se(e) { var t; return Boolean((t = e) === null || void 0 === t ? void 0 : t.shadowRoot) } function Me(e) { return e = e || Object.create(null), {on: function(t, n) { (e[t] || (e[t] = [])).push(n) }, off: function(t, n) { e[t] && e[t].splice(e[t].indexOf(n) >>> 0, 1) }, emit: function(t, n) { (e[t] || []).slice().map(function(e) { e(n) }), (e["*"] || []).slice().map(function(e) { e(t, n) }) }} } var Te = Object.freeze({__proto__: null, default: Me}); function ke(e, t) { if (void 0 === e && (e = window), void 0 === t && (t = document), !("scrollBehavior" in t.documentElement.style) || !0 === e.__forceSmoothScrollPolyfill__) { var n, r = e.HTMLElement || e.Element, o = {scroll: e.scroll || e.scrollTo, scrollBy: e.scrollBy, elementScroll: r.prototype.scroll || s, scrollIntoView: r.prototype.scrollIntoView}, i = e.performance && e.performance.now ? e.performance.now.bind(e.performance) : Date.now, a = (n = e.navigator.userAgent, new RegExp(["MSIE ", "Trident/", "Edge/"].join("|")).test(n) ? 1 : 0); e.scroll = e.scrollTo = function() { void 0 !== arguments[0] && (!0 !== l(arguments[0]) ? h.call(e, t.body, void 0 !== arguments[0].left ? ~~arguments[0].left : e.scrollX || e.pageXOffset, void 0 !== arguments[0].top ? ~~arguments[0].top : e.scrollY || e.pageYOffset) : o.scroll.call(e, void 0 !== arguments[0].left ? arguments[0].left : typeof arguments[0] != "object" ? arguments[0] : e.scrollX || e.pageXOffset, void 0 !== arguments[0].top ? arguments[0].top : void 0 !== arguments[1] ? arguments[1] : e.scrollY || e.pageYOffset)) }, e.scrollBy = function() { void 0 !== arguments[0] && (l(arguments[0]) ? o.scrollBy.call(e, void 0 !== arguments[0].left ? arguments[0].left : typeof arguments[0] != "object" ? arguments[0] : 0, void 0 !== arguments[0].top ? arguments[0].top : void 0 !== arguments[1] ? arguments[1] : 0) : h.call(e, t.body, ~~arguments[0].left + (e.scrollX || e.pageXOffset), ~~arguments[0].top + (e.scrollY || e.pageYOffset))) }, r.prototype.scroll = r.prototype.scrollTo = function() { if (void 0 !== arguments[0]) if (!0 !== l(arguments[0])) { var e = arguments[0].left, t = arguments[0].top; h.call(this, this, void 0 === e ? this.scrollLeft : ~~e, void 0 === t ? this.scrollTop : ~~t) } else { if (typeof arguments[0] == "number" && void 0 === arguments[1]) throw new SyntaxError("Value could not be converted"); o.elementScroll.call(this, void 0 !== arguments[0].left ? ~~arguments[0].left : typeof arguments[0] != "object" ? ~~arguments[0] : this.scrollLeft, void 0 !== arguments[0].top ? ~~arguments[0].top : void 0 !== arguments[1] ? ~~arguments[1] : this.scrollTop) } }, r.prototype.scrollBy = function() { void 0 !== arguments[0] && (!0 !== l(arguments[0]) ? this.scroll({left: ~~arguments[0].left + this.scrollLeft, top: ~~arguments[0].top + this.scrollTop, behavior: arguments[0].behavior}) : o.elementScroll.call(this, void 0 !== arguments[0].left ? ~~arguments[0].left + this.scrollLeft : ~~arguments[0] + this.scrollLeft, void 0 !== arguments[0].top ? ~~arguments[0].top + this.scrollTop : ~~arguments[1] + this.scrollTop)) }, r.prototype.scrollIntoView = function() { if (!0 !== l(arguments[0])) { var n = f(this), r = n.getBoundingClientRect(), i = this.getBoundingClientRect(); n !== t.body ? (h.call(this, n, n.scrollLeft + i.left - r.left, n.scrollTop + i.top - r.top), e.getComputedStyle(n).position !== "fixed" && e.scrollBy({left: r.left, top: r.top, behavior: "smooth"})) : e.scrollBy({left: i.left, top: i.top, behavior: "smooth"}) } else o.scrollIntoView.call(this, void 0 === arguments[0] || arguments[0]) } } function s(e, t) { this.scrollLeft = e, this.scrollTop = t } function l(e) { if (e === null || typeof e != "object" || void 0 === e.behavior || e.behavior === "auto" || e.behavior === "instant") return !0; if (typeof e == "object" && e.behavior === "smooth") return !1; throw new TypeError("behavior member of ScrollOptions " + e.behavior + " is not a valid value for enumeration ScrollBehavior.") } function c(e, t) { return t === "Y" ? e.clientHeight + a < e.scrollHeight : t === "X" ? e.clientWidth + a < e.scrollWidth : void 0 } function u(t, n) { var r = e.getComputedStyle(t, null)["overflow" + n]; return r === "auto" || r === "scroll" } function d(e) { var t = c(e, "Y") && u(e, "Y"), n = c(e, "X") && u(e, "X"); return t || n } function f(e) { for (;e !== t.body && !1 === d(e);)e = e.parentNode || e.host; return e } function p(t) { var n, r, o, a = (i() - t.startTime) / 468; n = (function(e) { return 0.5 * (1 - Math.cos(Math.PI * e)) }(a = a > 1 ? 1 : a)), r = t.startX + (t.x - t.startX) * n, o = t.startY + (t.y - t.startY) * n, t.method.call(t.scrollable, r, o), r === t.x && o === t.y || e.requestAnimationFrame(p.bind(e, t)) } function h(n, r, a) { var l, c, u, d, f = i(); n === t.body ? (l = e, c = e.scrollX || e.pageXOffset, u = e.scrollY || e.pageYOffset, d = o.scroll) : (l = n, c = n.scrollLeft, u = n.scrollTop, d = s), p({scrollable: l, method: d, startTime: f, startX: c, startY: u, x: r, y: a}) } } var Ce, Ie = (function() { function e(e, t) { void 0 === e && (e = []), this.timeOffset = 0, this.raf = null, this.actions = e, this.speed = t } return e.prototype.addAction = function(e) { var t = this.findActionIndex(e); this.actions.splice(t, 0, e) }, e.prototype.addActions = function(e) { this.actions = this.actions.concat(e) }, e.prototype.start = function() { this.timeOffset = 0; var e = performance.now(), t = this.actions, n = this; this.raf = requestAnimationFrame(function r() { var o = performance.now(); for (n.timeOffset += (o - e) * n.speed, e = o; t.length;) { var i = t[0]; if (!(n.timeOffset >= i.delay)) break; t.shift(), i.doAction() }(t.length > 0 || n.liveMode) && (n.raf = requestAnimationFrame(r)) }) }, e.prototype.clear = function() { this.raf && (cancelAnimationFrame(this.raf), this.raf = null), this.actions.length = 0 }, e.prototype.setSpeed = function(e) { this.speed = e }, e.prototype.toggleLiveMode = function(e) { this.liveMode = e }, e.prototype.isActive = function() { return this.raf !== null }, e.prototype.findActionIndex = function(e) { for (var t = 0, n = this.actions.length - 1; t <= n;) { var r = Math.floor((t + n) / 2); if (this.actions[r].delay < e.delay)t = r + 1; else { if (!(this.actions[r].delay > e.delay)) return r; n = r - 1 } } return t }, e }()); function Ne(e, t) { if (e.type === G.IncrementalSnapshot && e.data.source === J.MouseMove) { var n = e.data.positions[0].timeOffset, r = e.timestamp + n; return e.delay = r - t, r - t } return e.delay = e.timestamp - t, e.delay }
  /*! *****************************************************************************
      Copyright (c) Microsoft Corporation. All rights reserved.
      Licensed under the Apache License, Version 2.0 (the "License"); you may not use
      this file except in compliance with the License. You may obtain a copy of the
      License at http://www.apache.org/licenses/LICENSE-2.0

      THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
      KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
      WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
      MERCHANTABLITY OR NON-INFRINGEMENT.

      See the Apache Version 2.0 License for specific language governing permissions
      and limitations under the License.
      ***************************************************************************** */!(function(e) { e[e.NotStarted = 0] = "NotStarted", e[e.Running = 1] = "Running", e[e.Stopped = 2] = "Stopped" }(Ce || (Ce = {}))); var _e = {type: "xstate.init"}; function $e(e) { return void 0 === e ? [] : [].concat(e) } function Ae(e) { return {type: "xstate.assign", assignment: e} } function De(e, t) { return typeof (e = typeof e == "string" && t && t[e] ? t[e] : e) == "string" ? {type: e} : typeof e == "function" ? {type: e.name, exec: e} : e } function Fe(e) { return function(t) { return e === t } } function Oe(e) { return typeof e == "string" ? {type: e} : e } function Le(e, t) { return {value: e, context: t, actions: [], changed: !1, matches: Fe(e)} } function Pe(e, t) { void 0 === t && (t = {}); var n = {config: e, _options: t, initialState: {value: e.initial, actions: $e(e.states[e.initial].entry).map(function(e) { return De(e, t.actions) }), context: e.context, matches: Fe(e.initial)}, transition: function(t, r) { var o, i, a = typeof t == "string" ? {value: t, context: e.context} : t, s = a.value, l = a.context, c = Oe(r), u = e.states[s]; if (u.on) { var d = $e(u.on[c.type]), f = function(t) { if (void 0 === t) return {value: Le(s, l)}; var r = typeof t == "string" ? {target: t} : t, o = r.target, i = void 0 === o ? s : o, a = r.actions, d = void 0 === a ? [] : a, f = r.cond, p = l; if ((void 0 === f ? function() { return !0 } : f)(l, c)) { var h = e.states[i], m = !1, v = [].concat(u.exit, d, h.entry).filter(function(e) { return e }).map(function(e) { return De(e, n._options.actions) }).filter(function(e) { if (e.type === "xstate.assign") { m = !0; var t = Object.assign({}, p); return typeof e.assignment == "function" ? t = e.assignment(p, c) : Object.keys(e.assignment).forEach(function(n) { t[n] = typeof e.assignment[n] == "function" ? e.assignment[n](p, c) : e.assignment[n] }), p = t, !1 } return !0 }); return {value: {value: i, context: p, actions: v, changed: i !== s || v.length > 0 || m, matches: Fe(i)}} } }; try { for (var p = (function(e) { var t = typeof Symbol == "function" && e[Symbol.iterator], n = 0; return t ? t.call(e) : {next: function() { return e && n >= e.length && (e = void 0), {value: e && e[n++], done: !e} }} }(d)), h = p.next(); !h.done; h = p.next()) { var m = f(h.value); if (typeof m == "object") return m.value } } catch (e) { o = {error: e} } finally { try { h && !h.done && (i = p.return) && i.call(p) } finally { if (o) throw o.error } } } return Le(s, l) }}; return n } var Re = function(e, t) { return e.actions.forEach(function(n) { var r = n.exec; return r && r(e.context, t) }) }; function je(e) { var t = e.initialState, n = Ce.NotStarted, r = new Set(), o = {_machine: e, send: function(o) { n === Ce.Running && (t = e.transition(t, o), Re(t, Oe(o)), r.forEach(function(e) { return e(t) })) }, subscribe: function(e) { return r.add(e), e(t), {unsubscribe: function() { return r.delete(e) }} }, start: function(r) { if (r) { var i = typeof r == "object" ? r : {context: e.config.context, value: r}; t = {value: i.value, actions: [], context: i.context, matches: Fe(i.value)} } return n = Ce.Running, Re(t, _e), o }, stop: function() { return n = Ce.Stopped, r.clear(), o }, get state() { return t }, get status() { return n }}; return o } function Be(e, t) { var n = t.getCastFn, r = t.emitter; return je(Pe({id: "player", context: e, initial: "paused", states: {playing: {on: {PAUSE: {target: "paused", actions: ["pause"]}, CAST_EVENT: {target: "playing", actions: "castEvent"}, END: {target: "paused", actions: ["resetLastPlayedEvent", "pause"]}, ADD_EVENT: {target: "playing", actions: ["addEvent"]}}}, paused: {on: {PLAY: {target: "playing", actions: ["recordTimeOffset", "play"]}, CAST_EVENT: {target: "paused", actions: "castEvent"}, TO_LIVE: {target: "live", actions: ["startLive"]}, ADD_EVENT: {target: "paused", actions: ["addEvent"]}}}, live: {on: {ADD_EVENT: {target: "live", actions: ["addEvent"]}, CAST_EVENT: {target: "live", actions: ["castEvent"]}}}}}, {actions: {castEvent: Ae({lastPlayedEvent: function(e, t) { return t.type === "CAST_EVENT" ? t.payload.event : e.lastPlayedEvent }}), recordTimeOffset: Ae(function(e, t) { var n = e.timeOffset; return "payload" in t && "timeOffset" in t.payload && (n = t.payload.timeOffset), ne(ne({}, e), {timeOffset: n, baselineTime: e.events[0].timestamp + n}) }), play: function(e) { var t, o, i, a, s, l = e.timer, c = e.events, u = e.baselineTime, d = e.lastPlayedEvent; l.clear(); try { for (var f = re(c), p = f.next(); !p.done; p = f.next()) { Ne(p.value, u) } } catch (e) { t = {error: e} } finally { try { p && !p.done && (o = f.return) && o.call(f) } finally { if (t) throw t.error } } var h = (function(e, t) { for (var n = e.length - 1; n >= 0; n--) { var r = e[n]; if (r.type === G.Meta && r.timestamp <= t) return e.slice(n) } return e }(c, u)), m = d == null ? void 0 : d.timestamp; (d == null ? void 0 : d.type) === G.IncrementalSnapshot && d.data.source === J.MouseMove && (m = d.timestamp + ((s = d.data.positions[0]) === null || void 0 === s ? void 0 : s.timeOffset)), u < (m || 0) && r.emit(ee.PlayBack); var v = new Array(), g = function(e) { if (m && m < u && (e.timestamp <= m || e === d)) return "continue"; var t = e.timestamp < u; if (t && !(function(e) { switch (e.type) { case G.DomContentLoaded:case G.Load:case G.Custom:return !1; case G.FullSnapshot:case G.Meta:return !0 } switch (e.data.source) { case J.MouseMove:case J.MouseInteraction:case J.TouchMove:case J.MediaInteraction:return !1; case J.ViewportResize:case J.StyleSheetRule:case J.Scroll:case J.Input:return !0 } return !0 }(e))) return "continue"; var o = n(e, t); t ? o() : v.push({doAction: function() { o(), r.emit(ee.EventCast, e) }, delay: e.delay}) }; try { for (var y = re(h), w = y.next(); !w.done; w = y.next()) { g(w.value) } } catch (e) { i = {error: e} } finally { try { w && !w.done && (a = y.return) && a.call(y) } finally { if (i) throw i.error } }r.emit(ee.Flush), l.addActions(v), l.start() }, pause: function(e) { e.timer.clear() }, resetLastPlayedEvent: Ae(function(e) { return r.emit(ee.PlayBack), ne(ne({}, e), {lastPlayedEvent: null}) }), startLive: Ae({baselineTime: function(e, t) { return e.timer.toggleLiveMode(!0), e.timer.start(), t.type === "TO_LIVE" && t.payload.baselineTime ? t.payload.baselineTime : Date.now() }}), addEvent: Ae(function(e, t) { var o = e.baselineTime, i = e.timer, a = e.events; if (t.type === "ADD_EVENT") { var s = t.payload.event; Ne(s, o); var l = a.length - 1; if (!a[l] || a[l].timestamp <= s.timestamp)a.push(s); else { for (var c = -1, u = 0; u <= l;) { var d = Math.floor((u + l) / 2); a[d].timestamp <= s.timestamp ? u = d + 1 : l = d - 1 }c === -1 && (c = u), a.splice(c, 0, s) }r.emit(ee.AddEventEnd, s); var f = s.timestamp < o, p = n(s, f); f ? p() : i.isActive() && i.addAction({doAction: function() { p(), r.emit(ee.EventCast, s) }, delay: s.delay}) } return ne(ne({}, e), {events: a}) })}})) } var ze = Me || Te, qe = {duration: 500, lineCap: "round", lineWidth: 3, strokeStyle: "red"}, Ue = {level: ["assert", "clear", "count", "countReset", "debug", "dir", "dirxml", "error", "group", "groupCollapsed", "groupEnd", "info", "log", "table", "time", "timeEnd", "timeLog", "trace", "warn"], replayLogger: void 0}, Ve = (function() { function e(e, t) { var n = this; if (this.mouseTail = null, this.tailPositions = [], this.emitter = ze(), this.legacy_missingNodeRetryMap = {}, this.imageMap = new Map(), this.mirror = {map: {}, getId: function(e) { return e.__sn ? e.__sn.id : -1 }, getNode: function(e) { return this.map[e] || null }, removeNodeFromMap: function(e) { var t = this, n = e.__sn && e.__sn.id; delete this.map[n], e.childNodes && e.childNodes.forEach(function(e) { return t.removeNodeFromMap(e) }) }, has: function(e) { return this.map.hasOwnProperty(e) }, reset: function() { this.map = {} }}, this.firstPlayedEvent = null, this.newDocumentQueue = [], !(t == null ? void 0 : t.liveMode) && e.length < 2) throw new Error("Replayer need at least 2 events."); var r = {speed: 1, maxSpeed: 360, root: document.body, loadTimeout: 0, skipInactive: !1, showWarning: !0, showDebug: !1, blockClass: "rr-block", liveMode: !1, insertStyleRules: [], triggerFocus: !0, UNSAFE_replayCanvas: !1, pauseAnimation: !0, mouseTail: qe, logConfig: Ue}; this.config = Object.assign({}, r, t), this.config.logConfig.replayLogger || (this.config.logConfig.replayLogger = this.getConsoleLogger()), this.handleResize = this.handleResize.bind(this), this.getCastFn = this.getCastFn.bind(this), this.emitter.on(ee.Resize, this.handleResize), this.setupDom(), this.treeIndex = new we(), this.fragmentParentMap = new Map(), this.elementStateMap = new Map(), this.emitter.on(ee.Flush, function() { var e, t, r, o, i = n.treeIndex.flush(), a = i.scrollMap, s = i.inputMap; n.fragmentParentMap.forEach(function(e, t) { return n.restoreRealParent(t, e) }), n.fragmentParentMap.clear(), n.elementStateMap.clear(); try { for (var l = re(a.values()), c = l.next(); !c.done; c = l.next()) { var u = c.value; n.applyScroll(u) } } catch (t) { e = {error: t} } finally { try { c && !c.done && (t = l.return) && t.call(l) } finally { if (e) throw e.error } } try { for (var d = re(s.values()), f = d.next(); !f.done; f = d.next()) { u = f.value; n.applyInput(u) } } catch (e) { r = {error: e} } finally { try { f && !f.done && (o = d.return) && o.call(d) } finally { if (r) throw r.error } } }), this.emitter.on(ee.PlayBack, function() { n.firstPlayedEvent = null, n.mirror.reset() }); var o = new Ie([], (t == null ? void 0 : t.speed) || r.speed); this.service = Be({events: e.map(function(e) { return t && t.unpackFn ? t.unpackFn(e) : e }).sort(function(e, t) { return e.timestamp - t.timestamp }), timer: o, timeOffset: 0, baselineTime: 0, lastPlayedEvent: null}, {getCastFn: this.getCastFn, emitter: this.emitter}), this.service.start(), this.service.subscribe(function(e) { n.emitter.emit(ee.StateChange, {player: e}) }), this.speedService = je(Pe({id: "speed", context: {normalSpeed: -1, timer: o}, initial: "normal", states: {normal: {on: {FAST_FORWARD: {target: "skipping", actions: ["recordSpeed", "setSpeed"]}, SET_SPEED: {target: "normal", actions: ["setSpeed"]}}}, skipping: {on: {BACK_TO_NORMAL: {target: "normal", actions: ["restoreSpeed"]}, SET_SPEED: {target: "normal", actions: ["setSpeed"]}}}}}, {actions: {setSpeed: function(e, t) { "payload" in t && e.timer.setSpeed(t.payload.speed) }, recordSpeed: Ae({normalSpeed: function(e) { return e.timer.speed }}), restoreSpeed: function(e) { e.timer.setSpeed(e.normalSpeed) }}})), this.speedService.start(), this.speedService.subscribe(function(e) { n.emitter.emit(ee.StateChange, {speed: e}) }); var i = this.service.state.context.events.find(function(e) { return e.type === G.Meta }), a = this.service.state.context.events.find(function(e) { return e.type === G.FullSnapshot }); if (i) { var s = i.data, l = s.width, c = s.height; setTimeout(function() { n.emitter.emit(ee.Resize, {width: l, height: c}) }, 0) }a && setTimeout(function() { n.firstPlayedEvent || (n.firstPlayedEvent = a, n.rebuildFullSnapshot(a), n.iframe.contentWindow.scrollTo(a.data.initialOffset)) }, 1) } return Object.defineProperty(e.prototype, "timer", {get: function() { return this.service.state.context.timer }, enumerable: !1, configurable: !0}), e.prototype.on = function(e, t) { return this.emitter.on(e, t), this }, e.prototype.off = function(e, t) { return this.emitter.off(e, t), this }, e.prototype.setConfig = function(e) { var t = this; Object.keys(e).forEach(function(n) { t.config[n] = e[n] }), this.config.skipInactive || this.backToNormal(), void 0 !== e.speed && this.speedService.send({type: "SET_SPEED", payload: {speed: e.speed}}), void 0 !== e.mouseTail && (!1 === e.mouseTail ? this.mouseTail && (this.mouseTail.style.display = "none") : (this.mouseTail || (this.mouseTail = document.createElement("canvas"), this.mouseTail.width = Number.parseFloat(this.iframe.width), this.mouseTail.height = Number.parseFloat(this.iframe.height), this.mouseTail.classList.add("replayer-mouse-tail"), this.wrapper.insertBefore(this.mouseTail, this.iframe)), this.mouseTail.style.display = "inherit")) }, e.prototype.getMetaData = function() { var e = this.service.state.context.events[0], t = this.service.state.context.events[this.service.state.context.events.length - 1]; return {startTime: e.timestamp, endTime: t.timestamp, totalTime: t.timestamp - e.timestamp} }, e.prototype.getCurrentTime = function() { return this.timer.timeOffset + this.getTimeOffset() }, e.prototype.getTimeOffset = function() { var e = this.service.state.context; return e.baselineTime - e.events[0].timestamp }, e.prototype.getMirror = function() { return this.mirror }, e.prototype.play = function(e) { var t; void 0 === e && (e = 0), this.service.state.matches("paused") || this.service.send({type: "PAUSE"}), this.service.send({type: "PLAY", payload: {timeOffset: e}}), (t = this.iframe.contentDocument) === null || void 0 === t || t.getElementsByTagName("html")[0].classList.remove("rrweb-paused"), this.emitter.emit(ee.Start) }, e.prototype.pause = function(e) { var t; void 0 === e && this.service.state.matches("playing") && this.service.send({type: "PAUSE"}), typeof e == "number" && (this.play(e), this.service.send({type: "PAUSE"})), (t = this.iframe.contentDocument) === null || void 0 === t || t.getElementsByTagName("html")[0].classList.add("rrweb-paused"), this.emitter.emit(ee.Pause) }, e.prototype.resume = function(e) { void 0 === e && (e = 0), console.warn("The 'resume' will be departed in 1.0. Please use 'play' method which has the same interface."), this.play(e), this.emitter.emit(ee.Resume) }, e.prototype.startLive = function(e) { this.service.send({type: "TO_LIVE", payload: {baselineTime: e}}) }, e.prototype.addEvent = function(e) { var t = this, n = this.config.unpackFn ? this.config.unpackFn(e) : e; Promise.resolve().then(function() { return t.service.send({type: "ADD_EVENT", payload: {event: n}}) }) }, e.prototype.enableInteract = function() { this.iframe.setAttribute("scrolling", "auto"), this.iframe.style.pointerEvents = "auto" }, e.prototype.disableInteract = function() { this.iframe.setAttribute("scrolling", "no"), this.iframe.style.pointerEvents = "none" }, e.prototype.setupDom = function() { this.wrapper = document.createElement("div"), this.wrapper.classList.add("replayer-wrapper"), this.config.root.appendChild(this.wrapper), this.mouse = document.createElement("div"), this.mouse.classList.add("replayer-mouse"), this.wrapper.appendChild(this.mouse), !1 !== this.config.mouseTail && (this.mouseTail = document.createElement("canvas"), this.mouseTail.classList.add("replayer-mouse-tail"), this.mouseTail.style.display = "inherit", this.wrapper.appendChild(this.mouseTail)), this.iframe = document.createElement("iframe"); var e, t = ["allow-same-origin"]; this.config.UNSAFE_replayCanvas && t.push("allow-scripts"), this.iframe.style.display = "none", this.iframe.setAttribute("sandbox", t.join(" ")), this.disableInteract(), this.wrapper.appendChild(this.iframe), this.iframe.contentWindow && this.iframe.contentDocument && (ke(this.iframe.contentWindow, this.iframe.contentDocument), void 0 === (e = this.iframe.contentWindow) && (e = window), "NodeList" in e && !e.NodeList.prototype.forEach && (e.NodeList.prototype.forEach = Array.prototype.forEach), "DOMTokenList" in e && !e.DOMTokenList.prototype.forEach && (e.DOMTokenList.prototype.forEach = Array.prototype.forEach), Node.prototype.contains || (Node.prototype.contains = function(e) { if (!(0 in arguments)) throw new TypeError("1 argument is required"); do { if (this === e) return !0 } while (e = e && e.parentNode);return !1 })) }, e.prototype.handleResize = function(e) { var t, n; this.iframe.style.display = "inherit"; try { for (var r = re([this.mouseTail, this.iframe]), o = r.next(); !o.done; o = r.next()) { var i = o.value; i && (i.setAttribute("width", String(e.width)), i.setAttribute("height", String(e.height))) } } catch (e) { t = {error: e} } finally { try { o && !o.done && (n = r.return) && n.call(r) } finally { if (t) throw t.error } } }, e.prototype.getCastFn = function(e, t) { var n, r = this; switch (void 0 === t && (t = !1), e.type) { case G.DomContentLoaded:case G.Load:break; case G.Custom:n = function() { r.emitter.emit(ee.CustomEvent, e) }; break; case G.Meta:n = function() { return r.emitter.emit(ee.Resize, {width: e.data.width, height: e.data.height}) }; break; case G.FullSnapshot:n = function() { r.firstPlayedEvent && r.firstPlayedEvent === e || (r.rebuildFullSnapshot(e, t), r.iframe.contentWindow.scrollTo(e.data.initialOffset)) }; break; case G.IncrementalSnapshot:n = function() { var n, o; if (r.applyIncremental(e, t), !t && (e === r.nextUserInteractionEvent && (r.nextUserInteractionEvent = null, r.backToNormal()), r.config.skipInactive && !r.nextUserInteractionEvent)) { try { for (var i = re(r.service.state.context.events), a = i.next(); !a.done; a = i.next()) { var s = a.value; if (!(s.timestamp <= e.timestamp) && r.isUserInteraction(s)) { s.delay - e.delay > 1e4 * r.speedService.state.context.timer.speed && (r.nextUserInteractionEvent = s); break } } } catch (e) { n = {error: e} } finally { try { a && !a.done && (o = i.return) && o.call(i) } finally { if (n) throw n.error } } if (r.nextUserInteractionEvent) { var l = r.nextUserInteractionEvent.delay - e.delay, c = {speed: Math.min(Math.round(l / 5e3), r.config.maxSpeed)}; r.speedService.send({type: "FAST_FORWARD", payload: c}), r.emitter.emit(ee.SkipStart, c) } } } } return function() { if (n && n(), r.service.send({type: "CAST_EVENT", payload: {event: e}}), e === r.service.state.context.events[r.service.state.context.events.length - 1]) { var t = function() { r.backToNormal(), r.service.send("END"), r.emitter.emit(ee.Finish) }; e.type === G.IncrementalSnapshot && e.data.source === J.MouseMove && e.data.positions.length ? setTimeout(function() { t() }, Math.max(0, 50 - e.data.positions[0].timeOffset)) : t() } } }, e.prototype.rebuildFullSnapshot = function(e, t) { var n, r, o = this; if (void 0 === t && (t = !1), !this.iframe.contentDocument) return console.warn("Looks like your replayer has been destroyed."); Object.keys(this.legacy_missingNodeRetryMap).length && console.warn("Found unresolved missing node map", this.legacy_missingNodeRetryMap), this.legacy_missingNodeRetryMap = {}; var i = []; this.mirror.map = ve(e.data.node, {doc: this.iframe.contentDocument, afterAppend: function(e) { o.collectIframeAndAttachDocument(i, e) }})[1]; var a = function(e, t) { if (s.attachDocumentToIframe(e, t), s.newDocumentQueue = s.newDocumentQueue.filter(function(t) { return t !== e }), t.contentDocument) { var n = t.contentDocument, r = n.documentElement, o = n.head; s.insertStyleRules(r, o) } }, s = this; try { for (var l = re(i), c = l.next(); !c.done; c = l.next()) { var u = c.value; a(u.mutationInQueue, u.builtNode) } } catch (e) { n = {error: e} } finally { try { c && !c.done && (r = l.return) && r.call(l) } finally { if (n) throw n.error } } var d = this.iframe.contentDocument, f = d.documentElement, p = d.head; this.insertStyleRules(f, p), this.service.state.matches("playing") || this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"), this.emitter.emit(ee.FullsnapshotRebuilded, e), t || this.waitForStylesheetLoad(), this.config.UNSAFE_replayCanvas && this.preloadAllImages() }, e.prototype.insertStyleRules = function(e, t) { var n = document.createElement("style"); e.insertBefore(n, t); var r, o = (r = this.config.blockClass, ["." + r + " { background: #ccc }", "noscript { display: none !important; }"]).concat(this.config.insertStyleRules); this.config.pauseAnimation && o.push("html.rrweb-paused * { animation-play-state: paused !important; }"); for (var i = 0; i < o.length; i++)n.sheet.insertRule(o[i], i) }, e.prototype.attachDocumentToIframe = function(e, t) { var n, r, o = this, i = []; if (!t.contentDocument) for (var a = t.parentNode; a;) { if (this.fragmentParentMap.has(a)) { var s = a, l = this.fragmentParentMap.get(s); this.restoreRealParent(s, l); break }a = a.parentNode }me(e.node, {doc: t.contentDocument, map: this.mirror.map, hackCss: !0, skipChild: !1, afterAppend: function(e) { o.collectIframeAndAttachDocument(i, e) }}); var c = function(e, t) { if (u.attachDocumentToIframe(e, t), u.newDocumentQueue = u.newDocumentQueue.filter(function(t) { return t !== e }), t.contentDocument) { var n = t.contentDocument, r = n.documentElement, o = n.head; u.insertStyleRules(r, o) } }, u = this; try { for (var d = re(i), f = d.next(); !f.done; f = d.next()) { var p = f.value; c(p.mutationInQueue, p.builtNode) } } catch (e) { n = {error: e} } finally { try { f && !f.done && (r = d.return) && r.call(d) } finally { if (n) throw n.error } } }, e.prototype.collectIframeAndAttachDocument = function(e, t) { if (Ee(t)) { var n = this.newDocumentQueue.find(function(e) { return e.parentId === t.__sn.id }); n && e.push({mutationInQueue: n, builtNode: t}) } }, e.prototype.waitForStylesheetLoad = function() { var e, t = this, n = (e = this.iframe.contentDocument) === null || void 0 === e ? void 0 : e.head; if (n) { var r, o = new Set(), i = this.service.state, a = function() { i = t.service.state }; this.emitter.on(ee.Start, a), this.emitter.on(ee.Pause, a); var s = function() { t.emitter.off(ee.Start, a), t.emitter.off(ee.Pause, a) }; n.querySelectorAll('link[rel="stylesheet"]').forEach(function(e) { e.sheet || (o.add(e), e.addEventListener("load", function() { o.delete(e), o.size === 0 && r !== -1 && (i.matches("playing") && t.play(t.getCurrentTime()), t.emitter.emit(ee.LoadStylesheetEnd), r && window.clearTimeout(r), s()) })) }), o.size > 0 && (this.service.send({type: "PAUSE"}), this.emitter.emit(ee.LoadStylesheetStart), r = window.setTimeout(function() { i.matches("playing") && t.play(t.getCurrentTime()), r = -1, s() }, this.config.loadTimeout)) } }, e.prototype.preloadAllImages = function() { var e, t, n = this, r = (this.service.state, function() { n.service.state }); this.emitter.on(ee.Start, r), this.emitter.on(ee.Pause, r); var o = 0; try { for (var i = re(this.service.state.context.events), a = i.next(); !a.done; a = i.next()) { var s = a.value; if (s.type === G.IncrementalSnapshot && s.data.source === J.CanvasMutation && s.data.property === "drawImage" && typeof s.data.args[0] == "string" && !this.imageMap.has(s)) { o++; var l = document.createElement("canvas"), c = l.getContext("2d"), u = c == null ? void 0 : c.createImageData(l.width, l.height); u == null || u.data; JSON.parse(s.data.args[0]), c == null || c.putImageData(u, 0, 0) } } } catch (t) { e = {error: t} } finally { try { a && !a.done && (t = i.return) && t.call(i) } finally { if (e) throw e.error } }o !== 0 && this.service.send({type: "PAUSE"}) }, e.prototype.applyIncremental = function(e, t) { var n, r, o = this, i = e.data; switch (i.source) { case J.Mutation:t && (i.adds.forEach(function(e) { return o.treeIndex.add(e) }), i.texts.forEach(function(e) { return o.treeIndex.text(e) }), i.attributes.forEach(function(e) { return o.treeIndex.attribute(e) }), i.removes.forEach(function(e) { return o.treeIndex.remove(e, o.mirror) })), this.applyMutation(i, t); break; case J.MouseMove:if (t) { var a = i.positions[i.positions.length - 1]; this.moveAndHover(i, a.x, a.y, a.id) } else i.positions.forEach(function(t) { var n = {doAction: function() { o.moveAndHover(i, t.x, t.y, t.id) }, delay: t.timeOffset + e.timestamp - o.service.state.context.baselineTime}; o.timer.addAction(n) }), this.timer.addAction({doAction: function() {}, delay: e.delay - ((n = i.positions[0]) === null || void 0 === n ? void 0 : n.timeOffset)}); break; case J.MouseInteraction:if (i.id === -1) break; var s = new Event(K[i.type].toLowerCase()); if (!(v = this.mirror.getNode(i.id))) return this.debugNodeNotFound(i, i.id); this.emitter.emit(ee.MouseInteraction, {type: i.type, target: v}); var l = this.config.triggerFocus; switch (i.type) { case K.Blur:"blur" in v && v.blur(); break; case K.Focus:l && v.focus && v.focus({preventScroll: !0}); break; case K.Click:case K.TouchStart:case K.TouchEnd:t || (this.moveAndHover(i, i.x, i.y, i.id), this.mouse.classList.remove("active"), this.mouse.offsetWidth, this.mouse.classList.add("active")); break; default:v.dispatchEvent(s) } break; case J.Scroll:if (i.id === -1) break; if (t) { this.treeIndex.scroll(i); break } this.applyScroll(i); break; case J.ViewportResize:this.emitter.emit(ee.Resize, {width: i.width, height: i.height}); break; case J.Input:if (i.id === -1) break; if (t) { this.treeIndex.input(i); break } this.applyInput(i); break; case J.MediaInteraction:if (!(v = this.mirror.getNode(i.id))) return this.debugNodeNotFound(i, i.id); var c = v; try { i.type === Z.Pause && c.pause(), i.type === Z.Play && (c.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA ? c.play() : c.addEventListener("canplay", function() { c.play() })) } catch (e) { this.config.showWarning && console.warn("Failed to replay media interactions: " + (e.message || e)) } break; case J.StyleSheetRule:if (!(v = this.mirror.getNode(i.id))) return this.debugNodeNotFound(i, i.id); var u = v, d = v.parentNode, f = this.fragmentParentMap.has(d), p = void 0; if (f) { var h = this.fragmentParentMap.get(v.parentNode); p = document.createTextNode(""), d.replaceChild(p, v), h.appendChild(v) } var m = u.sheet; i.adds && i.adds.forEach(function(e) { var t = e.rule, n = e.index; try { var r = void 0 === n ? void 0 : Math.min(n, m.rules.length); try { m.insertRule(t, r) } catch (e) {} } catch (e) {} }), i.removes && i.removes.forEach(function(e) { var t = e.index; try { m.deleteRule(t) } catch (e) {} }), f && p && d.replaceChild(v, p); break; case J.CanvasMutation:if (!this.config.UNSAFE_replayCanvas) return; var v; if (!(v = this.mirror.getNode(i.id))) return this.debugNodeNotFound(i, i.id); try { var g = v.getContext("2d"); if (i.setter) return void (g[i.property] = i.args[0]); var y = g[i.property]; if (i.property === "drawImage" && typeof i.args[0] == "string") { var w = this.imageMap.get(e); i.args[0] = w, y.apply(g, i.args) } else y.apply(g, i.args) } catch (e) { this.warnCanvasMutationFailed(i, i.id, e) } break; case J.Font:try { var b = new FontFace(i.family, i.buffer ? new Uint8Array(JSON.parse(i.fontSource)) : i.fontSource, i.descriptors); (r = this.iframe.contentDocument) === null || void 0 === r || r.fonts.add(b) } catch (e) { this.config.showWarning && console.warn(e) } break; case J.Log:try { var x = e.data, E = this.config.logConfig.replayLogger; typeof E[x.level] == "function" && E[x.level](x) } catch (e) { this.config.showWarning && console.warn(e) } } }, e.prototype.applyMutation = function(e, t) { var n, r, o = this; e.removes.forEach(function(t) { var n = o.mirror.getNode(t.id); if (!n) return o.warnNodeNotFound(e, t.id); var r = o.mirror.getNode(t.parentId); if (!r) return o.warnNodeNotFound(e, t.parentId); if (t.isShadow && Se(r) && (r = r.shadowRoot), o.mirror.removeNodeFromMap(n), r) { var i = "__sn" in r ? o.fragmentParentMap.get(r) : void 0; if (i && i.contains(n))i.removeChild(n); else if (o.fragmentParentMap.has(n)) { var a = o.fragmentParentMap.get(n); r.removeChild(a), o.fragmentParentMap.delete(n) } else r.removeChild(n) } }); var i = ne({}, this.legacy_missingNodeRetryMap), a = [], s = function(e) { var n, r; if (!o.iframe.contentDocument) return console.warn("Looks like your replayer has been destroyed."); var s = o.mirror.getNode(e.parentId); if (!s) return e.node.type === te.Document ? o.newDocumentQueue.push(e) : a.push(e); var l = null; o.iframe.contentDocument.contains ? l = o.iframe.contentDocument.contains(s) : o.iframe.contentDocument.body.contains && (l = o.iframe.contentDocument.body.contains(s)); var c = ((r = (n = s).getElementsByTagName) === null || void 0 === r ? void 0 : r.call(n, "iframe").length) > 0; if (t && l && !Ee(s) && !c) { var u = document.createDocumentFragment(); for (o.mirror.map[e.parentId] = u, o.fragmentParentMap.set(u, s), o.storeState(s); s.firstChild;)u.appendChild(s.firstChild); s = u }e.node.isShadow && Se(s) && (s = s.shadowRoot); var d = null, f = null; if (e.previousId && (d = o.mirror.getNode(e.previousId)), e.nextId && (f = o.mirror.getNode(e.nextId)), (function(e) { var t = null; return e.nextId && (t = o.mirror.getNode(e.nextId)), e.nextId !== null && void 0 !== e.nextId && e.nextId !== -1 && !t }(e))) return a.push(e); if (!e.node.rootId || o.mirror.getNode(e.node.rootId)) { var p = e.node.rootId ? o.mirror.getNode(e.node.rootId) : o.iframe.contentDocument; if (Ee(s))o.attachDocumentToIframe(e, s); else { var h = me(e.node, {doc: p, map: o.mirror.map, skipChild: !0, hackCss: !0}); if (e.previousId !== -1 && e.nextId !== -1) { if (d && d.nextSibling && d.nextSibling.parentNode)s.insertBefore(h, d.nextSibling); else if (f && f.parentNode)s.contains(f) ? s.insertBefore(h, f) : s.insertBefore(h, null); else { if (s === p) for (;p.firstChild;)p.removeChild(p.firstChild); s.appendChild(h) } if (Ee(h)) { var m = o.newDocumentQueue.find(function(e) { return e.parentId === h.__sn.id }); if (m && (o.attachDocumentToIframe(m, h), o.newDocumentQueue = o.newDocumentQueue.filter(function(e) { return e !== m })), h.contentDocument) { var v = h.contentDocument, g = v.documentElement, y = v.head; o.insertStyleRules(g, y) } }(e.previousId || e.nextId) && o.legacy_resolveMissingNode(i, s, h, e) } else i[e.node.id] = {node: h, mutation: e} } } }; e.adds.forEach(function(e) { s(e) }); for (var l = Date.now(); a.length;) { var c = be(a); if (a.length = 0, Date.now() - l > 500) { this.warn("Timeout in the loop, please check the resolve tree data:", c); break } try { for (var u = (n = void 0, re(c)), d = u.next(); !d.done; d = u.next()) { var f = d.value; this.mirror.getNode(f.value.parentId) ? xe(f, function(e) { s(e) }) : this.debug("Drop resolve tree since there is no parent for the root node.", f) } } catch (e) { n = {error: e} } finally { try { d && !d.done && (r = u.return) && r.call(u) } finally { if (n) throw n.error } } }Object.keys(i).length && Object.assign(this.legacy_missingNodeRetryMap, i), e.texts.forEach(function(t) { var n = o.mirror.getNode(t.id); if (!n) return o.warnNodeNotFound(e, t.id); o.fragmentParentMap.has(n) && (n = o.fragmentParentMap.get(n)), n.textContent = t.value }), e.attributes.forEach(function(t) { var n = o.mirror.getNode(t.id); if (!n) return o.warnNodeNotFound(e, t.id); if (!Ee(n)) for (var r in o.fragmentParentMap.has(n) && (n = o.fragmentParentMap.get(n)), t.attributes) if (typeof r == "string") { var i = t.attributes[r]; try { i !== null ? n.setAttribute(r, i) : n.removeAttribute(r) } catch (e) { o.config.showWarning && console.warn("An error occurred may due to the checkout feature.", e) } } }) }, e.prototype.applyScroll = function(e) { var t = this.mirror.getNode(e.id); if (!t) return this.debugNodeNotFound(e, e.id); if (t === this.iframe.contentDocument) this.iframe.contentWindow.scrollTo({top: e.y, left: e.x, behavior: "smooth"}); else try { t.documentElement ? (t.documentElement.scrollTop = e.y, t.documentElement.scrollLeft = e.x) : (t.scrollTop = e.y, t.scrollLeft = e.x) } catch (e) {} }, e.prototype.applyInput = function(e) { var t = this.mirror.getNode(e.id); if (!t) return this.debugNodeNotFound(e, e.id); try { t.checked = e.isChecked, t.value = e.text } catch (e) {} }, e.prototype.formatMessage = function(e) { if (e.trace.length === 0) return ""; var t = "\n\tat "; return t += e.trace.join("\n\tat ") }, e.prototype.getConsoleLogger = function() { var e, t, n = this, r = {}, o = function(e) { r[e] = e === "trace" ? function(e) { (console.log.__rrweb_original__ ? console.log.__rrweb_original__ : console.log).apply(void 0, ie(e.payload.map(function(e) { return JSON.parse(e) }), [n.formatMessage(e)])) } : function(t) { (console[e].__rrweb_original__ ? console[e].__rrweb_original__ : console[e]).apply(void 0, ie(t.payload.map(function(e) { return JSON.parse(e) }), [n.formatMessage(t)])) } }; try { for (var i = re(this.config.logConfig.level), a = i.next(); !a.done; a = i.next()) { o(a.value) } } catch (t) { e = {error: t} } finally { try { a && !a.done && (t = i.return) && t.call(i) } finally { if (e) throw e.error } } return r }, e.prototype.legacy_resolveMissingNode = function(e, t, n, r) { var o = r.previousId, i = r.nextId, a = o && e[o], s = i && e[i]; if (a) { var l = a, c = l.node, u = l.mutation; t.insertBefore(c, n), delete e[u.node.id], delete this.legacy_missingNodeRetryMap[u.node.id], (u.previousId || u.nextId) && this.legacy_resolveMissingNode(e, t, c, u) } if (s) { var d = s; c = d.node, u = d.mutation; t.insertBefore(c, n.nextSibling), delete e[u.node.id], delete this.legacy_missingNodeRetryMap[u.node.id], (u.previousId || u.nextId) && this.legacy_resolveMissingNode(e, t, c, u) } }, e.prototype.moveAndHover = function(e, t, n, r) { var o = this.mirror.getNode(r); if (!o) return this.debugNodeNotFound(e, r); var i = (function e(t, n) { var r, o, i = (o = (r = t.ownerDocument) === null || void 0 === r ? void 0 : r.defaultView) === null || void 0 === o ? void 0 : o.frameElement; if (!i || i === n) return {x: 0, y: 0, relativeScale: 1, absoluteScale: 1}; var a = i.getBoundingClientRect(), s = e(i, n), l = a.height / i.clientHeight; return {x: a.x * s.relativeScale + s.x, y: a.y * s.relativeScale + s.y, relativeScale: l, absoluteScale: s.absoluteScale * l} }(o, this.iframe)), a = t * i.absoluteScale + i.x, s = n * i.absoluteScale + i.y; this.mouse.style.left = a + "px", this.mouse.style.top = s + "px", this.drawMouseTail({x: a, y: s}), this.hoverElements(o) }, e.prototype.drawMouseTail = function(e) { var t = this; if (this.mouseTail) { var n = !0 === this.config.mouseTail ? qe : Object.assign({}, qe, this.config.mouseTail), r = n.lineCap, o = n.lineWidth, i = n.strokeStyle, a = n.duration, s = function() { if (t.mouseTail) { var e = t.mouseTail.getContext("2d"); e && t.tailPositions.length && (e.clearRect(0, 0, t.mouseTail.width, t.mouseTail.height), e.beginPath(), e.lineWidth = o, e.lineCap = r, e.strokeStyle = i, e.moveTo(t.tailPositions[0].x, t.tailPositions[0].y), t.tailPositions.forEach(function(t) { return e.lineTo(t.x, t.y) }), e.stroke()) } }; this.tailPositions.push(e), s(), setTimeout(function() { t.tailPositions = t.tailPositions.filter(function(t) { return t !== e }), s() }, a / this.speedService.state.context.timer.speed) } }, e.prototype.hoverElements = function(e) { var t; (t = this.iframe.contentDocument) === null || void 0 === t || t.querySelectorAll(".\\:hover").forEach(function(e) { e.classList.remove(":hover") }); for (var n = e; n;)n.classList && n.classList.add(":hover"), n = n.parentElement }, e.prototype.isUserInteraction = function(e) { return e.type === G.IncrementalSnapshot && (e.data.source > J.Mutation && e.data.source <= J.Input) }, e.prototype.backToNormal = function() { this.nextUserInteractionEvent = null, this.speedService.state.matches("normal") || (this.speedService.send({type: "BACK_TO_NORMAL"}), this.emitter.emit(ee.SkipEnd, {speed: this.speedService.state.context.normalSpeed})) }, e.prototype.restoreRealParent = function(e, t) { this.mirror.map[t.__sn.id] = t, t.__sn.type === te.Element && t.__sn.tagName === "textarea" && e.textContent && (t.value = e.textContent), t.appendChild(e), this.restoreState(t) }, e.prototype.storeState = function(e) { var t, n; if (e && e.nodeType === e.ELEMENT_NODE) { var r = e; (r.scrollLeft || r.scrollTop) && this.elementStateMap.set(e, {scroll: [r.scrollLeft, r.scrollTop]}); var o = r.children; try { for (var i = re(Array.from(o)), a = i.next(); !a.done; a = i.next()) { var s = a.value; this.storeState(s) } } catch (e) { t = {error: e} } finally { try { a && !a.done && (n = i.return) && n.call(i) } finally { if (t) throw t.error } } } }, e.prototype.restoreState = function(e) { var t, n; if (e.nodeType === e.ELEMENT_NODE) { var r = e; if (this.elementStateMap.has(e)) { var o = this.elementStateMap.get(e); o.scroll && (r.scrollLeft = o.scroll[0], r.scrollTop = o.scroll[1]), this.elementStateMap.delete(e) } var i = r.children; try { for (var a = re(Array.from(i)), s = a.next(); !s.done; s = a.next()) { var l = s.value; this.restoreState(l) } } catch (e) { t = {error: e} } finally { try { s && !s.done && (n = a.return) && n.call(a) } finally { if (t) throw t.error } } } }, e.prototype.warnNodeNotFound = function(e, t) { this.warn("Node with id '" + t + "' not found in", e) }, e.prototype.warnCanvasMutationFailed = function(e, t, n) { this.warn("Has error on update canvas '" + t + "'", e, n) }, e.prototype.debugNodeNotFound = function(e, t) { this.debug("[replayer]", "Node with id '" + t + "' not found in", e) }, e.prototype.warn = function() { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; this.config.showWarning && console.warn.apply(console, ie(["[replayer]"], e)) }, e.prototype.debug = function() { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; this.config.showDebug && console.log.apply(console, ie(["[replayer]"], e)) }, e }()), We = Uint8Array, He = Uint16Array, Xe = Uint32Array, Ye = new We([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]), Qe = new We([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]), Ge = new We([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]), Je = function(e, t) { for (var n = new He(31), r = 0; r < 31; ++r)n[r] = t += 1 << e[r - 1]; var o = new Xe(n[30]); for (r = 1; r < 30; ++r) for (var i = n[r]; i < n[r + 1]; ++i)o[i] = i - n[r] << 5 | r; return [n, o] }, Ke = Je(Ye, 2), Ze = Ke[0], et = Ke[1]; Ze[28] = 258, et[258] = 28; for (var tt = Je(Qe, 0)[0], nt = new He(32768), rt = 0; rt < 32768; ++rt) { var ot = (43690 & rt) >>> 1 | (21845 & rt) << 1; ot = (61680 & (ot = (52428 & ot) >>> 2 | (13107 & ot) << 2)) >>> 4 | (3855 & ot) << 4, nt[rt] = ((65280 & ot) >>> 8 | (255 & ot) << 8) >>> 1 } var it = function(e, t, n) { for (var r = e.length, o = 0, i = new He(t); o < r; ++o)++i[e[o] - 1]; var a, s = new He(t); for (o = 0; o < t; ++o)s[o] = s[o - 1] + i[o - 1] << 1; if (n) { a = new He(1 << t); var l = 15 - t; for (o = 0; o < r; ++o) if (e[o]) for (var c = o << 4 | e[o], u = t - e[o], d = s[e[o] - 1]++ << u, f = d | (1 << u) - 1; d <= f; ++d)a[nt[d] >>> l] = c } else for (a = new He(r), o = 0; o < r; ++o)a[o] = nt[s[e[o] - 1]++] >>> 15 - e[o]; return a }, at = new We(288); for (rt = 0; rt < 144; ++rt)at[rt] = 8; for (rt = 144; rt < 256; ++rt)at[rt] = 9; for (rt = 256; rt < 280; ++rt)at[rt] = 7; for (rt = 280; rt < 288; ++rt)at[rt] = 8; var st = new We(32); for (rt = 0; rt < 32; ++rt)st[rt] = 5; it(at, 9, 0); var lt = it(at, 9, 1), ct = (it(st, 5, 0), it(st, 5, 1)), ut = function(e) { for (var t = e[0], n = 1; n < e.length; ++n)e[n] > t && (t = e[n]); return t }, dt = function(e, t, n) { var r = t / 8 >> 0; return (e[r] | e[r + 1] << 8) >>> (7 & t) & n }, ft = function(e, t) { var n = t / 8 >> 0; return (e[n] | e[n + 1] << 8 | e[n + 2] << 16) >>> (7 & t) }, pt = function(e, t, n) { (t == null || t < 0) && (t = 0), (n == null || n > e.length) && (n = e.length); var r = new (e instanceof He ? He : e instanceof Xe ? Xe : We)(n - t); return r.set(e.subarray(t, n)), r }, ht = new Xe(256); for (rt = 0; rt < 256; ++rt) { for (var mt = rt, vt = 9; --vt;)mt = (1 & mt && 3988292384) ^ mt >>> 1; ht[rt] = mt } function gt(e, t) { return (function(e, t, n) { var r = e.length, o = !t || n, i = !n || n.i; n || (n = {}), t || (t = new We(3 * r)); var a = function(e) { var n = t.length; if (e > n) { var r = new We(Math.max(2 * n, e)); r.set(t), t = r } }, s = n.f || 0, l = n.p || 0, c = n.b || 0, u = n.l, d = n.d, f = n.m, p = n.n; if (s && !u) return t; var h, m = 8 * r; do { if (!u) { n.f = s = dt(e, l, 1); var v = dt(e, l + 1, 3); if (l += 3, !v) { var g = e[(I = ((h = l) / 8 >> 0) + (7 & h && 1) + 4) - 4] | e[I - 3] << 8, y = I + g; if (y > r) { if (i) throw "unexpected EOF"; break }o && a(c + g), t.set(e.subarray(I, y), c), n.b = c += g, n.p = l = 8 * y; continue } if (v == 1)u = lt, d = ct, f = 9, p = 5; else { if (v != 2) throw "invalid block type"; var w = dt(e, l, 31) + 257, b = dt(e, l + 10, 15) + 4, x = w + dt(e, l + 5, 31) + 1; l += 14; for (var E = new We(x), S = new We(19), M = 0; M < b; ++M)S[Ge[M]] = dt(e, l + 3 * M, 7); l += 3 * b; var T = ut(S), k = (1 << T) - 1; if (!i && l + x * (T + 7) > m) break; var C = it(S, T, 1); for (M = 0; M < x;) { var I, N = C[dt(e, l, k)]; if (l += 15 & N, (I = N >>> 4) < 16)E[M++] = I; else { var _ = 0, $ = 0; for (I == 16 ? ($ = 3 + dt(e, l, 3), l += 2, _ = E[M - 1]) : I == 17 ? ($ = 3 + dt(e, l, 7), l += 3) : I == 18 && ($ = 11 + dt(e, l, 127), l += 7); $--;)E[M++] = _ } } var A = E.subarray(0, w), D = E.subarray(w); f = ut(A), p = ut(D), u = it(A, f, 1), d = it(D, p, 1) } if (l > m) throw "unexpected EOF" }o && a(c + 131072); for (var F = (1 << f) - 1, O = (1 << p) - 1, L = f + p + 18; i || l + L < m;) { var P = (_ = u[ft(e, l) & F]) >>> 4; if ((l += 15 & _) > m) throw "unexpected EOF"; if (!_) throw "invalid length/literal"; if (P < 256)t[c++] = P; else { if (P == 256) { u = null; break } var R = P - 254; if (P > 264) { var j = Ye[M = P - 257]; R = dt(e, l, (1 << j) - 1) + Ze[M], l += j } var B = d[ft(e, l) & O], z = B >>> 4; if (!B) throw "invalid distance"; l += 15 & B; D = tt[z]; if (z > 3) { j = Qe[z]; D += ft(e, l) & (1 << j) - 1, l += j } if (l > m) throw "unexpected EOF"; o && a(c + 131072); for (var q = c + R; c < q; c += 4)t[c] = t[c - D], t[c + 1] = t[c + 1 - D], t[c + 2] = t[c + 2 - D], t[c + 3] = t[c + 3 - D]; c = q } }n.l = u, n.p = l, n.b = c, u && (s = 1, n.m = f, n.d = d, n.n = p) } while (!s);return c == t.length ? t : pt(t, 0, c) }(((function(e) { if ((15 & e[0]) != 8 || e[0] >>> 4 > 7 || (e[0] << 8 | e[1]) % 31) throw "invalid zlib data"; if (32 & e[1]) throw "invalid zlib data: preset dictionaries not supported" }(e)), e.subarray(2, -4)), t)) } var yt = function(e) { if (typeof e != "string") return e; try { if ((t = JSON.parse(e)).timestamp) return t } catch (e) {} try { var t; if ((t = JSON.parse(function(e, t) { var n = ""; if (!t && typeof TextDecoder != "undefined") return (new TextDecoder()).decode(e); for (var r = 0; r < e.length;) { var o = e[r++]; o < 128 || t ? n += String.fromCharCode(o) : o < 224 ? n += String.fromCharCode((31 & o) << 6 | 63 & e[r++]) : o < 240 ? n += String.fromCharCode((15 & o) << 12 | (63 & e[r++]) << 6 | 63 & e[r++]) : (o = ((15 & o) << 18 | (63 & e[r++]) << 12 | (63 & e[r++]) << 6 | 63 & e[r++]) - 65536, n += String.fromCharCode(55296 | o >> 10, 56320 | 1023 & o)) } return n }(gt(function(e, t) { var n = e.length; if (!t && typeof TextEncoder != "undefined") return (new TextEncoder()).encode(e); for (var r = new We(e.length + (e.length >>> 1)), o = 0, i = function(e) { r[o++] = e }, a = 0; a < n; ++a) { if (o + 5 > r.length) { var s = new We(o + 8 + (n - a << 1)); s.set(r), r = s } var l = e.charCodeAt(a); l < 128 || t ? i(l) : l < 2048 ? (i(192 | l >>> 6), i(128 | 63 & l)) : l > 55295 && l < 57344 ? (i(240 | (l = 65536 + (1047552 & l) | 1023 & e.charCodeAt(++a)) >>> 18), i(128 | l >>> 12 & 63), i(128 | l >>> 6 & 63), i(128 | 63 & l)) : (i(224 | l >>> 12), i(128 | l >>> 6 & 63), i(128 | 63 & l)) } return pt(r, 0, o) }(e, !0))))).v === "v1") return t; throw new Error("These events were packed with packer " + t.v + " which is incompatible with current packer v1.") } catch (e) { throw console.error(e), new Error("Unknown data format.") } }; function wt(e) { let t = ""; return Object.keys(e).forEach(n => { t += `${n}: ${e[n]};` }), t } function bt(e, t = 2) { let n = String(e); const r = Math.pow(10, t - 1); if (e < r) for (;String(r).length > n.length;)n = "0" + e; return n } function xt(e) { if (e <= 0) return "00:00"; const t = Math.floor(e / 36e5); e %= 36e5; const n = Math.floor(e / 6e4); e %= 6e4; const r = Math.floor(e / 1e3); return t ? `${bt(t)}:${bt(n)}:${bt(r)}` : `${bt(n)}:${bt(r)}` } function Et() { return document.fullscreen || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement } function St(e) { return {"[object Boolean]": "boolean", "[object Number]": "number", "[object String]": "string", "[object Function]": "function", "[object Array]": "array", "[object Date]": "date", "[object RegExp]": "regExp", "[object Undefined]": "undefined", "[object Null]": "null", "[object Object]": "object"}[Object.prototype.toString.call(e)] } function Mt(t) { let n, r, o, i, a, s, d, p, w; return {c() { n = f("div"), r = f("input"), o = m(), i = f("label"), a = m(), s = f("span"), d = h(t[3]), g(r, "type", "checkbox"), g(r, "id", t[2]), r.disabled = t[1], g(r, "class", "svelte-1mmdovf"), g(i, "for", t[2]), g(i, "class", "svelte-1mmdovf"), g(s, "class", "label svelte-1mmdovf"), g(n, "class", "switch svelte-1mmdovf"), b(n, "disabled", t[1]) }, m(e, u) { c(e, n, u), l(n, r), r.checked = t[0], l(n, o), l(n, i), l(n, a), l(n, s), l(s, d), p || (w = v(r, "change", t[4]), p = !0) }, p(e, [t]) { 4 & t && g(r, "id", e[2]), 2 & t && (r.disabled = e[1]), 1 & t && (r.checked = e[0]), 4 & t && g(i, "for", e[2]), 8 & t && y(d, e[3]), 2 & t && b(n, "disabled", e[1]) }, i: e, o: e, d(e) { e && u(n), p = !1, w() }} } function Tt(e, t, n) { let{disabled: r} = t, {checked: o} = t, {id: i} = t, {label: a} = t; return e.$set = e => { "disabled" in e && n(1, r = e.disabled), "checked" in e && n(0, o = e.checked), "id" in e && n(2, i = e.id), "label" in e && n(3, a = e.label) }, [o, r, i, a, function() { o = this.checked, n(0, o) }] } class kt extends Q {constructor(e) { super(), Y(this, e, Tt, Mt, a, {disabled: 1, checked: 0, id: 2, label: 3}) }} function Ct(e, t, n) { const r = e.slice(); return r[33] = t[n], r } function It(e, t, n) { const r = e.slice(); return r[36] = t[n], r } function Nt(e) { let t, n, r, i, a, s, p, x, E, S, M, T, k, C, N, $, A, D, F, O, L, P, R, j, B, z = xt(e[6]) + "", X = xt(e[11].totalTime) + "", Y = e[13], Q = []; for (let t = 0; t < Y.length; t += 1)Q[t] = _t(It(e, Y, t)); function G(e, t) { return e[7] === "playing" ? At : $t }let J = G(e), K = J(e), Z = e[3], ee = []; for (let t = 0; t < Z.length; t += 1)ee[t] = Dt(Ct(e, Z, t)); function te(t) { e[27].call(null, t) }let ne = {id: "skip", disabled: e[8] === "skipping", label: "skip inactive"}; return void 0 !== e[0] && (ne.checked = e[0]), F = new kt({props: ne}), I.push(() => (function(e, t, n) { const r = e.$$.props[t]; void 0 !== r && (e.$$.bound[r] = n, n(e.$$.ctx[r])) }(F, "checked", te))), {c() { t = f("div"), n = f("div"), r = f("span"), i = h(z), a = m(), s = f("div"), p = f("div"), x = m(); for (let e = 0; e < Q.length; e += 1)Q[e].c(); E = m(), S = f("div"), M = m(), T = f("span"), k = h(X), C = m(), N = f("div"), $ = f("button"), K.c(), A = m(); for (let e = 0; e < ee.length; e += 1)ee[e].c(); D = m(), V(F.$$.fragment), L = m(), P = f("button"), P.innerHTML = '<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M916 380c-26.4 0-48-21.6-48-48L868 223.2 613.6 477.6c-18.4\n            18.4-48.8 18.4-68 0-18.4-18.4-18.4-48.8 0-68L800 156 692 156c-26.4\n            0-48-21.6-48-48 0-26.4 21.6-48 48-48l224 0c26.4 0 48 21.6 48 48l0\n            224C964 358.4 942.4 380 916 380zM231.2 860l108.8 0c26.4 0 48 21.6 48\n            48s-21.6 48-48 48l-224 0c-26.4 0-48-21.6-48-48l0-224c0-26.4 21.6-48\n            48-48 26.4 0 48 21.6 48 48L164 792l253.6-253.6c18.4-18.4 48.8-18.4\n            68 0 18.4 18.4 18.4 48.8 0 68L231.2 860z" p-id="1286"></path></svg>', g(r, "class", "rr-timeline__time svelte-dxnc1j"), g(p, "class", "rr-progress__step svelte-dxnc1j"), w(p, "width", e[12]), g(S, "class", "rr-progress__handler svelte-dxnc1j"), w(S, "left", e[12]), g(s, "class", "rr-progress svelte-dxnc1j"), b(s, "disabled", e[8] === "skipping"), g(T, "class", "rr-timeline__time svelte-dxnc1j"), g(n, "class", "rr-timeline svelte-dxnc1j"), g($, "class", "svelte-dxnc1j"), g(P, "class", "svelte-dxnc1j"), g(N, "class", "rr-controller__btns svelte-dxnc1j"), g(t, "class", "rr-controller svelte-dxnc1j") }, m(o, u) { c(o, t, u), l(t, n), l(n, r), l(r, i), l(n, a), l(n, s), l(s, p), e[23](p), l(s, x); for (let e = 0; e < Q.length; e += 1)Q[e].m(s, null); l(s, E), l(s, S), e[24](s), l(n, M), l(n, T), l(T, k), l(t, C), l(t, N), l(N, $), K.m($, null), l(N, A); for (let e = 0; e < ee.length; e += 1)ee[e].m(N, null); l(N, D), W(F, N, null), l(N, L), l(N, P), R = !0, j || (B = [v(s, "click", e[25]), v($, "click", e[4]), v(P, "click", e[28])], j = !0) }, p(e, t) { if ((!R || 64 & t[0]) && z !== (z = xt(e[6]) + "") && y(i, z), (!R || 4096 & t[0]) && w(p, "width", e[12]), 8192 & t[0]) { let n; for (Y = e[13], n = 0; n < Y.length; n += 1) { const r = It(e, Y, n); Q[n] ? Q[n].p(r, t) : (Q[n] = _t(r), Q[n].c(), Q[n].m(s, E)) } for (;n < Q.length; n += 1)Q[n].d(1); Q.length = Y.length } if ((!R || 4096 & t[0]) && w(S, "left", e[12]), 256 & t[0] && b(s, "disabled", e[8] === "skipping"), (!R || 2048 & t[0]) && X !== (X = xt(e[11].totalTime) + "") && y(k, X), J !== (J = G(e)) && (K.d(1), K = J(e), K && (K.c(), K.m($, null))), 298 & t[0]) { let n; for (Z = e[3], n = 0; n < Z.length; n += 1) { const r = Ct(e, Z, n); ee[n] ? ee[n].p(r, t) : (ee[n] = Dt(r), ee[n].c(), ee[n].m(N, D)) } for (;n < ee.length; n += 1)ee[n].d(1); ee.length = Z.length } const n = {}; var r; 256 & t[0] && (n.disabled = e[8] === "skipping"), !O && 1 & t[0] && (O = !0, n.checked = e[0], r = () => O = !1, _.push(r)), F.$set(n) }, i(e) { R || (q(F.$$.fragment, e), R = !0) }, o(e) { U(F.$$.fragment, e), R = !1 }, d(n) { n && u(t), e[23](null), d(Q, n), e[24](null), K.d(), d(ee, n), H(F), j = !1, o(B) }} } function _t(e) { let t, n; return {c() { t = f("div"), g(t, "title", n = e[36].name), w(t, "width", "10px"), w(t, "height", "5px"), w(t, "position", "absolute"), w(t, "top", "2px"), w(t, "transform", "translate(-50%, -50%)"), w(t, "background", e[36].background), w(t, "left", e[36].position) }, m(e, n) { c(e, t, n) }, p(e, r) { 8192 & r[0] && n !== (n = e[36].name) && g(t, "title", n), 8192 & r[0] && w(t, "background", e[36].background), 8192 & r[0] && w(t, "left", e[36].position) }, d(e) { e && u(t) }} } function $t(e) { let t, n; return {c() { t = p("svg"), n = p("path"), g(n, "d", "M170.65984 896l0-768 640 384zM644.66944\r\n              512l-388.66944-233.32864 0 466.65728z"), g(t, "class", "icon"), g(t, "viewBox", "0 0 1024 1024"), g(t, "version", "1.1"), g(t, "xmlns", "http://www.w3.org/2000/svg"), g(t, "xmlns:xlink", "http://www.w3.org/1999/xlink"), g(t, "width", "16"), g(t, "height", "16") }, m(e, r) { c(e, t, r), l(t, n) }, d(e) { e && u(t) }} } function At(e) { let t, n; return {c() { t = p("svg"), n = p("path"), g(n, "d", "M682.65984 128q53.00224 0 90.50112 37.49888t37.49888 90.50112l0\r\n              512q0 53.00224-37.49888 90.50112t-90.50112\r\n              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224\r\n              37.49888-90.50112t90.50112-37.49888zM341.34016 128q53.00224 0\r\n              90.50112 37.49888t37.49888 90.50112l0 512q0 53.00224-37.49888\r\n              90.50112t-90.50112\r\n              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224\r\n              37.49888-90.50112t90.50112-37.49888zM341.34016 213.34016q-17.67424\r\n              0-30.16704 12.4928t-12.4928 30.16704l0 512q0 17.67424 12.4928\r\n              30.16704t30.16704 12.4928 30.16704-12.4928\r\n              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928zM682.65984\r\n              213.34016q-17.67424 0-30.16704 12.4928t-12.4928 30.16704l0 512q0\r\n              17.67424 12.4928 30.16704t30.16704 12.4928 30.16704-12.4928\r\n              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928z"), g(t, "class", "icon"), g(t, "viewBox", "0 0 1024 1024"), g(t, "version", "1.1"), g(t, "xmlns", "http://www.w3.org/2000/svg"), g(t, "xmlns:xlink", "http://www.w3.org/1999/xlink"), g(t, "width", "16"), g(t, "height", "16") }, m(e, r) { c(e, t, r), l(t, n) }, d(e) { e && u(t) }} } function Dt(e) { let t, n, r, o, i, a, s = e[33] + ""; function d(...t) { return e[26](e[33], ...t) } return {c() { t = f("button"), n = h(s), r = h("x"), t.disabled = o = e[8] === "skipping", g(t, "class", "svelte-dxnc1j"), b(t, "active", e[33] === e[1] && e[8] !== "skipping") }, m(e, o) { c(e, t, o), l(t, n), l(t, r), i || (a = v(t, "click", d), i = !0) }, p(r, i) { e = r, 8 & i[0] && s !== (s = e[33] + "") && y(n, s), 256 & i[0] && o !== (o = e[8] === "skipping") && (t.disabled = o), 266 & i[0] && b(t, "active", e[33] === e[1] && e[8] !== "skipping") }, d(e) { e && u(t), i = !1, a() }} } function Ft(e) { let t, n, r = e[2] && Nt(e); return {c() { r && r.c(), t = h("") }, m(e, o) { r && r.m(e, o), c(e, t, o), n = !0 }, p(e, n) { e[2] ? r ? (r.p(e, n), 4 & n[0] && q(r, 1)) : (r = Nt(e), r.c(), q(r, 1), r.m(t.parentNode, t)) : r && (B(), U(r, 1, 1, () => { r = null }), z()) }, i(e) { n || (q(r), n = !0) }, o(e) { U(r), n = !1 }, d(e) { r && r.d(e), e && u(t) }} } function Ot(e, t, n) { const r = k(); let o, i, a, s, l, c, u, d, {replayer: f} = t, {showController: p} = t, {autoPlay: h} = t, {skipInactive: m} = t, {speedOption: v} = t, {speed: g = (v.length ? v[0] : 1)} = t, {tags: y = {}} = t, w = 0, b = null; const x = () => { b && (cancelAnimationFrame(b), b = null) }, E = () => { o === "paused" && (l ? (f.play(), l = !1) : f.play(w)) }, C = () => { o === "playing" && f.pause() }, N = e => { n(6, w = e); const t = o === "playing"; f.pause(), f.play(e), t || f.pause() }, _ = e => { if (i === "skipping") return; const t = a.getBoundingClientRect(); let n = (e.clientX - t.left) / t.width; n < 0 ? n = 0 : n > 1 && (n = 1); const r = c.totalTime * n; N(r) }, $ = e => { let t = o === "playing"; n(1, g = e), t && f.pause(), f.setConfig({speed: g}), t && f.play(w) }; var A; M(() => { n(7, o = f.service.state.value), n(8, i = f.speedService.state.value), f.on("state-change", e => { const {player: t, speed: r} = e; if ((t == null ? void 0 : t.value) && o !== t.value) switch (n(7, o = t.value), o) { case "playing":x(), b = requestAnimationFrame(function e() { n(6, w = f.getCurrentTime()), w < c.totalTime && (b = requestAnimationFrame(e)) }); break; case "paused":x() }(r == null ? void 0 : r.value) && i !== r.value && n(8, i = r.value) }), f.on("finish", () => { l = !0 }), f.on("add-event-end", () => { n(11, c = f.getMetaData()) }), h && f.play() }), A = () => { m !== f.config.skipInactive && f.setConfig({skipInactive: m}) }, S().$$.after_update.push(A), T(() => { f.pause(), x() }); return e.$set = e => { "replayer" in e && n(16, f = e.replayer), "showController" in e && n(2, p = e.showController), "autoPlay" in e && n(17, h = e.autoPlay), "skipInactive" in e && n(0, m = e.skipInactive), "speedOption" in e && n(3, v = e.speedOption), "speed" in e && n(1, g = e.speed), "tags" in e && n(18, y = e.tags) }, e.$$.update = () => { if (64 & e.$$.dirty[0] && r("ui-update-current-time", {payload: w}), 128 & e.$$.dirty[0] && r("ui-update-player-state", {payload: o}), 65536 & e.$$.dirty[0] && n(11, c = f.getMetaData()), 2112 & e.$$.dirty[0]) { const e = Math.min(1, w / c.totalTime); n(12, u = 100 * e + "%"), r("ui-update-progress", {payload: e}) }327680 & e.$$.dirty[0] && n(13, d = (() => { const {context: e} = f.service.state, t = e.events.length, n = e.events[0].timestamp, r = e.events[t - 1].timestamp, o = []; return e.events.forEach(e => { if (e.type === G.Custom) { const s = {name: e.data.tag, background: y[e.data.tag] || "rgb(73, 80, 246)", position: (t = n, i = r, a = e.timestamp, (100 - (i - a) / (i - t) * 100).toFixed(2)) + "%"}; o.push(s) } var t, i, a }), o })()) }, [m, g, p, v, () => { switch (o) { case "playing":C(); break; case "paused":E() } }, $, w, o, i, a, s, c, u, d, r, _, f, h, y, E, C, N, () => { n(0, m = !m) }, function(e) { I[e ? "unshift" : "push"](() => { s = e, n(10, s) }) }, function(e) { I[e ? "unshift" : "push"](() => { a = e, n(9, a) }) }, e => _(e), e => $(e), function(e) { m = e, n(0, m) }, () => r("fullscreen")] } class Lt extends Q {constructor(e) { super(), Y(this, e, Ot, Ft, a, {replayer: 16, showController: 2, autoPlay: 17, skipInactive: 0, speedOption: 3, speed: 1, tags: 18, toggle: 4, play: 19, pause: 20, goto: 21, setSpeed: 5, toggleSkipInactive: 22}, [-1, -1]) } get toggle() { return this.$$.ctx[4] } get play() { return this.$$.ctx[19] } get pause() { return this.$$.ctx[20] } get goto() { return this.$$.ctx[21] } get setSpeed() { return this.$$.ctx[5] } get toggleSkipInactive() { return this.$$.ctx[22] }} function Pt(e) { let t, n, r = {replayer: e[8], showController: e[3], autoPlay: e[1], speedOption: e[2], skipInactive: e[0], tags: e[4]}; return t = new Lt({props: r}), e[29](t), t.$on("fullscreen", e[30]), {c() { V(t.$$.fragment) }, m(e, r) { W(t, e, r), n = !0 }, p(e, n) { const r = {}; 256 & n[0] && (r.replayer = e[8]), 8 & n[0] && (r.showController = e[3]), 2 & n[0] && (r.autoPlay = e[1]), 4 & n[0] && (r.speedOption = e[2]), 1 & n[0] && (r.skipInactive = e[0]), 16 & n[0] && (r.tags = e[4]), t.$set(r) }, i(e) { n || (q(t.$$.fragment, e), n = !0) }, o(e) { U(t.$$.fragment, e), n = !1 }, d(n) { e[29](null), H(t, n) }} } function Rt(e) { let t, n, r, o, i = e[8] && Pt(e); return {c() { t = f("div"), n = f("div"), r = m(), i && i.c(), g(n, "class", "rr-player__frame"), g(n, "style", e[10]), g(t, "class", "rr-player"), g(t, "style", e[11]) }, m(a, s) { c(a, t, s), l(t, n), e[28](n), l(t, r), i && i.m(t, null), e[31](t), o = !0 }, p(e, r) { (!o || 1024 & r[0]) && g(n, "style", e[10]), e[8] ? i ? (i.p(e, r), 256 & r[0] && q(i, 1)) : (i = Pt(e), i.c(), q(i, 1), i.m(t, null)) : i && (B(), U(i, 1, 1, () => { i = null }), z()), (!o || 2048 & r[0]) && g(t, "style", e[11]) }, i(e) { o || (q(i), o = !0) }, o(e) { U(i), o = !1 }, d(n) { n && u(t), e[28](null), i && i.d(), e[31](null) }} } function jt(e, n, r) { let{width: o = 1024} = n, {height: i = 576} = n, {events: a = []} = n, {skipInactive: l = !0} = n, {autoPlay: c = !0} = n, {speedOption: u = [1, 2, 4, 8]} = n, {speed: d = 1} = n, {showController: f = !0} = n, {tags: p = {}} = n; let h, m, v, g, y, w, b, x = o, E = i; const S = (e, t) => { const n = o / t.width, r = i / t.height; e.style.transform = `scale(${Math.min(n, r, 1)})translate(-50%, -50%)` }, k = () => { var e; h && (Et() ? document.exitFullscreen ? document.exitFullscreen() : document.mozExitFullscreen ? document.mozExitFullscreen() : document.webkitExitFullscreen ? document.webkitExitFullscreen() : document.msExitFullscreen && document.msExitFullscreen() : (e = h).requestFullscreen ? e.requestFullscreen() : e.mozRequestFullScreen ? e.mozRequestFullScreen() : e.webkitRequestFullscreen ? e.webkitRequestFullscreen() : e.msRequestFullscreen && e.msRequestFullscreen()) }; M(() => { if (void 0 !== u && St(u) !== "array") throw new Error("speedOption must be array"); if (u.forEach(e => { if (St(e) !== "number") throw new Error("item of speedOption must be number") }), u.indexOf(d) < 0) throw new Error(`speed must be one of speedOption,\n      current config:\n      {\n        ...\n        speed: ${d},\n        speedOption: [${u.toString()}]\n        ...\n      }\n      `); var e; r(8, v = new Ve(a, Object.assign({speed: d, root: m, unpackFn: yt}, n))), v.on("resize", e => { S(v.wrapper, e) }), e = () => { Et() ? setTimeout(() => { x = o, E = i, r(12, o = h.offsetWidth), r(13, i = h.offsetHeight), S(v.wrapper, {width: v.iframe.offsetWidth, height: v.iframe.offsetHeight}) }, 0) : (r(12, o = x), r(13, i = E), S(v.wrapper, {width: v.iframe.offsetWidth, height: v.iframe.offsetHeight})) }, document.addEventListener("fullscreenchange", e), document.addEventListener("webkitfullscreenchange", e), document.addEventListener("mozfullscreenchange", e), document.addEventListener("MSFullscreenChange", e), g = () => { document.removeEventListener("fullscreenchange", e), document.removeEventListener("webkitfullscreenchange", e), document.removeEventListener("mozfullscreenchange", e), document.removeEventListener("MSFullscreenChange", e) } }), T(() => { g && g() }); return e.$set = e => { r(36, n = t(t({}, n), s(e))), "width" in e && r(12, o = e.width), "height" in e && r(13, i = e.height), "events" in e && r(14, a = e.events), "skipInactive" in e && r(0, l = e.skipInactive), "autoPlay" in e && r(1, c = e.autoPlay), "speedOption" in e && r(2, u = e.speedOption), "speed" in e && r(15, d = e.speed), "showController" in e && r(3, f = e.showController), "tags" in e && r(4, p = e.tags) }, e.$$.update = () => { 12288 & e.$$.dirty[0] && r(10, w = wt({width: o + "px", height: i + "px"})), 12296 & e.$$.dirty[0] && r(11, b = wt({width: o + "px", height: i + (f ? 80 : 0) + "px"})) }, n = s(n), [l, c, u, f, p, k, h, m, v, y, w, b, o, i, a, d, () => ye, () => { S(v.wrapper, {width: v.iframe.offsetWidth, height: v.iframe.offsetHeight}) }, (e, t) => { switch (v.on(e, t), e) { case "ui-update-current-time":case "ui-update-progress":case "ui-update-player-state":y.$on(e, ({detail: e}) => t(e)) } }, e => { v.addEvent(e) }, () => v.getMetaData(), () => v, () => { y.toggle() }, e => { y.setSpeed(e) }, () => { y.toggleSkipInactive() }, () => { y.play() }, () => { y.pause() }, e => { y.goto(e) }, function(e) { I[e ? "unshift" : "push"](() => { m = e, r(7, m) }) }, function(e) { I[e ? "unshift" : "push"](() => { y = e, r(9, y) }) }, () => k(), function(e) { I[e ? "unshift" : "push"](() => { h = e, r(6, h) }) }] } class Bt extends Q {constructor(e) { super(), Y(this, e, jt, Rt, a, {width: 12, height: 13, events: 14, skipInactive: 0, autoPlay: 1, speedOption: 2, speed: 15, showController: 3, tags: 4, getMirror: 16, triggerResize: 17, toggleFullscreen: 5, addEventListener: 18, addEvent: 19, getMetaData: 20, getReplayer: 21, toggle: 22, setSpeed: 23, toggleSkipInactive: 24, play: 25, pause: 26, goto: 27}, [-1, -1]) } get getMirror() { return this.$$.ctx[16] } get triggerResize() { return this.$$.ctx[17] } get toggleFullscreen() { return this.$$.ctx[5] } get addEventListener() { return this.$$.ctx[18] } get addEvent() { return this.$$.ctx[19] } get getMetaData() { return this.$$.ctx[20] } get getReplayer() { return this.$$.ctx[21] } get toggle() { return this.$$.ctx[22] } get setSpeed() { return this.$$.ctx[23] } get toggleSkipInactive() { return this.$$.ctx[24] } get play() { return this.$$.ctx[25] } get pause() { return this.$$.ctx[26] } get goto() { return this.$$.ctx[27] }} return class extends Bt {constructor(e) { super({target: e.target, props: e.data || e.props}) }}
}());
